{"paragraphs":[{"text":"%md\n# Prediction Flight Delays with Spark ML\nThis notebook demonstrates how to use Apache Spark’s ML pipelines with a Decision Tree Classifier to predict flight delays. For more information, see [this](https://mapr.com/blog/fast-data-processing-pipeline-predicting-flight-delays-using-apache-apis-pt-1/) post on the MapR blog, by Carol McDonald.\n<img src=\"https://mapr.com/blog/fast-data-processing-pipeline-predicting-flight-delays-using-apache-apis-pt-1/assets/spark-rdd-based-api.png\">","user":"anonymous","dateUpdated":"2019-02-20T17:36:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550683974952_569686372","id":"20190220-173254_1728425170","dateCreated":"2019-02-20T17:32:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:62597","dateFinished":"2019-02-20T17:36:14+0000","dateStarted":"2019-02-20T17:36:14+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Prediction Flight Delays with Spark ML</h1>\n<p>This notebook demonstrates how to use Apache Spark’s ML pipelines with a Decision Tree Classifier to predict flight delays. For more information, see <a href=\"https://mapr.com/blog/fast-data-processing-pipeline-predicting-flight-delays-using-apache-apis-pt-1/\">this</a> post on the MapR blog, by Carol McDonald.<br/><img src=\"https://mapr.com/blog/fast-data-processing-pipeline-predicting-flight-delays-using-apache-apis-pt-1/assets/spark-rdd-based-api.png\"></p>\n</div>"}]}},{"text":"%md \n## Data Exploration\nFor this tutorial, we'll be using data from http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time.\nThe CSV data has been cleaned and tranformed into 2 JSON files with the following format: \n{\"dofM\":1,\"dofW\":7,\"carrier\":\"AA\",\"fldate\":\"2017-01-01\",\"flnum\":\"1678\",\"origin\":\"ATL\",\"dest\":\"LGA\",\"crsdephour\":17,\"crsdeptime\":1700,\"depdelay\":0.0,\"crsarrtime\":1912,\"arrdelay\":0.0,\"crselapsedtime\":132.0,\"dist\":762.0}\n\nWe use a Scala case class and Structype to define the schema, corresponding to a line in the JSON data file.","user":"anonymous","dateUpdated":"2019-02-20T17:32:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Data Exploration</h2>\n<p>For this tutorial, we&rsquo;ll be using data from <a href=\"http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time\">http://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&DB_Short_Name=On-Time</a>.<br/>The CSV data has been cleaned and tranformed into 2 JSON files with the following format:<br/>{&ldquo;dofM&rdquo;:1,&ldquo;dofW&rdquo;:7,&ldquo;carrier&rdquo;:&ldquo;AA&rdquo;,&ldquo;fldate&rdquo;:&ldquo;2017-01-01&rdquo;,&ldquo;flnum&rdquo;:&ldquo;1678&rdquo;,&ldquo;origin&rdquo;:&ldquo;ATL&rdquo;,&ldquo;dest&rdquo;:&ldquo;LGA&rdquo;,&ldquo;crsdephour&rdquo;:17,&ldquo;crsdeptime&rdquo;:1700,&ldquo;depdelay&rdquo;:0.0,&ldquo;crsarrtime&rdquo;:1912,&ldquo;arrdelay&rdquo;:0.0,&ldquo;crselapsedtime&rdquo;:132.0,&ldquo;dist&rdquo;:762.0}</p>\n<p>We use a Scala case class and Structype to define the schema, corresponding to a line in the JSON data file.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1550681677648_-959193427","id":"20170530-122945_1594214131","dateCreated":"2019-02-20T16:54:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53188","dateFinished":"2019-02-20T17:32:25+0000","dateStarted":"2019-02-20T17:32:25+0000"},{"title":"Import needed packages","text":"%spark\nimport org.apache.spark._\nimport org.apache.spark.ml._\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.ml.classification._\nimport org.apache.spark.ml.evaluation._\nimport org.apache.spark.ml.tuning._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\n","user":"anonymous","dateUpdated":"2019-02-20T16:59:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark._\nimport org.apache.spark.ml._\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.ml.classification._\nimport org.apache.spark.ml.evaluation._\nimport org.apache.spark.ml.tuning._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\n"}]},"apps":[],"jobName":"paragraph_1550681677644_1176781811","id":"20170508-144514_403247535","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T16:59:22+0000","dateFinished":"2019-02-20T16:59:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:53186"},{"title":"Define Schema for JSON file data","text":"%spark\nimport org.apache.spark.sql.types._\n\ncase class Flight(_id: String, dofW: Integer, carrier: String, origin: String,\n    dest: String, crsdephour: Integer, crsdeptime: Double, depdelay: Double,\n    crsarrtime: Double, arrdelay: Double, crselapsedtime: Double, dist: Double)\n\n\nval schema = StructType(Array(\n    StructField(\"_id\", StringType, true),\n    StructField(\"dofW\", IntegerType, true),\n    StructField(\"carrier\", StringType, true),\n    StructField(\"origin\", StringType, true),\n    StructField(\"dest\", StringType, true),\n    StructField(\"crsdephour\", IntegerType, true),\n    StructField(\"crsdeptime\", DoubleType, true),\n    StructField(\"depdelay\", DoubleType, true),\n    StructField(\"crsarrtime\", DoubleType, true),\n    StructField(\"arrdelay\", DoubleType, true),\n    StructField(\"crselapsedtime\", DoubleType, true),\n    StructField(\"dist\", DoubleType, true)\n  ))\n   ","user":"anonymous","dateUpdated":"2019-02-20T16:59:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\ndefined class Flight\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(_id,StringType,true), StructField(dofW,IntegerType,true), StructField(carrier,StringType,true), StructField(origin,StringType,true), StructField(dest,StringType,true), StructField(crsdephour,IntegerType,true), StructField(crsdeptime,DoubleType,true), StructField(depdelay,DoubleType,true), StructField(crsarrtime,DoubleType,true), StructField(arrdelay,DoubleType,true), StructField(crselapsedtime,DoubleType,true), StructField(dist,DoubleType,true))\n"}]},"apps":[],"jobName":"paragraph_1550681677649_2134343163","id":"20170508-150032_326029627","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T16:59:35+0000","dateFinished":"2019-02-20T16:59:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53189"},{"title":"Read the data from JSON file into a Dataset of type Flight","text":"\nimport spark.implicits._\n\n var file =\"maprfs:///data/flights20170102.json\"\n\n val df: Dataset[Flight] = spark.read.format(\"json\").option(\"inferSchema\", \"false\").schema(schema).load(file).as[Flight]\n \n df.show\n","user":"anonymous","dateUpdated":"2019-02-20T16:59:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----+-------+------+----+----------+----------+--------+----------+--------+--------------+-----+\n|                 _id|dofW|carrier|origin|dest|crsdephour|crsdeptime|depdelay|crsarrtime|arrdelay|crselapsedtime| dist|\n+--------------------+----+-------+------+----+----------+----------+--------+----------+--------+--------------+-----+\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        11|    1141.0|     0.0|    1409.0|     0.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     WN|   ATL| BOS|        13|    1335.0|     0.0|    1600.0|     0.0|         145.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        14|    1416.0|     0.0|    1644.0|     0.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        16|    1616.0|    15.0|    1849.0|     0.0|         153.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     WN|   ATL| BOS|        18|    1845.0|     0.0|    2110.0|     0.0|         145.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        19|    1905.0|    15.0|    2133.0|     0.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        22|    2205.0|     0.0|      29.0|     0.0|         144.0|946.0|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|         9|     859.0|    30.0|    1127.0|    11.0|         148.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        10|    1004.0|    10.0|    1236.0|     3.0|         152.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        11|    1141.0|     0.0|    1410.0|    19.0|         149.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        13|    1305.0|    16.0|    1529.0|     5.0|         144.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        14|    1416.0|     0.0|    1646.0|     0.0|         150.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     WN|   ATL| BOS|        14|    1350.0|    25.0|    1615.0|    16.0|         145.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        15|    1510.0|    12.0|    1745.0|     4.0|         155.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        16|    1616.0|    68.0|    1852.0|    49.0|         156.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        18|    1750.0|    61.0|    2027.0|    64.0|         157.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        19|    1905.0|    36.0|    2135.0|    23.0|         150.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     WN|   ATL| BOS|        21|    2055.0|    74.0|    2325.0|    63.0|         150.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        22|    2205.0|    29.0|      32.0|    21.0|         147.0|946.0|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|         7|     725.0|     2.0|     954.0|     0.0|         149.0|946.0|\n+--------------------+----+-------+------+----+----------+----------+--------+----------+--------+--------------+-----+\nonly showing top 20 rows\n\nimport spark.implicits._\nfile: String = maprfs:///data/flights20170102.json\ndf: org.apache.spark.sql.Dataset[Flight] = [_id: string, dofW: int ... 10 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677649_1157838005","id":"20170508-150131_378637203","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T16:59:58+0000","dateFinished":"2019-02-20T17:00:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53190"},{"title":"Add origin_dest column  and display the first 20 rows","text":"val df1 = df.withColumn(\"orig_dest\", concat($\"origin\",lit(\"_\"), $\"dest\"))\ndf1.show()\n\n","user":"anonymous","dateUpdated":"2019-02-20T17:01:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----+-------+------+----+----------+----------+--------+----------+--------+--------------+-----+---------+\n|                 _id|dofW|carrier|origin|dest|crsdephour|crsdeptime|depdelay|crsarrtime|arrdelay|crselapsedtime| dist|orig_dest|\n+--------------------+----+-------+------+----+----------+----------+--------+----------+--------+--------------+-----+---------+\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        11|    1141.0|     0.0|    1409.0|     0.0|         148.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   7|     WN|   ATL| BOS|        13|    1335.0|     0.0|    1600.0|     0.0|         145.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        14|    1416.0|     0.0|    1644.0|     0.0|         148.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        16|    1616.0|    15.0|    1849.0|     0.0|         153.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   7|     WN|   ATL| BOS|        18|    1845.0|     0.0|    2110.0|     0.0|         145.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        19|    1905.0|    15.0|    2133.0|     0.0|         148.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|        22|    2205.0|     0.0|      29.0|     0.0|         144.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   7|     DL|   ATL| BOS|         9|     859.0|    30.0|    1127.0|    11.0|         148.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        10|    1004.0|    10.0|    1236.0|     3.0|         152.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        11|    1141.0|     0.0|    1410.0|    19.0|         149.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        13|    1305.0|    16.0|    1529.0|     5.0|         144.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        14|    1416.0|     0.0|    1646.0|     0.0|         150.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   1|     WN|   ATL| BOS|        14|    1350.0|    25.0|    1615.0|    16.0|         145.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        15|    1510.0|    12.0|    1745.0|     4.0|         155.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        16|    1616.0|    68.0|    1852.0|    49.0|         156.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        18|    1750.0|    61.0|    2027.0|    64.0|         157.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        19|    1905.0|    36.0|    2135.0|    23.0|         150.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   1|     WN|   ATL| BOS|        21|    2055.0|    74.0|    2325.0|    63.0|         150.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|        22|    2205.0|    29.0|      32.0|    21.0|         147.0|946.0|  ATL_BOS|\n|ATL_BOS_2017-01-0...|   1|     DL|   ATL| BOS|         7|     725.0|     2.0|     954.0|     0.0|         149.0|946.0|  ATL_BOS|\n+--------------------+----+-------+------+----+----------+----------+--------+----------+--------+--------------+-----+---------+\nonly showing top 20 rows\n\ndf1: org.apache.spark.sql.DataFrame = [_id: string, dofW: int ... 11 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677650_-1593999802","id":"20171129-221736_959969733","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:01:02+0000","dateFinished":"2019-02-20T17:01:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53191"},{"title":"Print DataFrame Schema","text":"df1.printSchema","user":"anonymous","dateUpdated":"2019-02-20T17:01:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- _id: string (nullable = true)\n |-- dofW: integer (nullable = true)\n |-- carrier: string (nullable = true)\n |-- origin: string (nullable = true)\n |-- dest: string (nullable = true)\n |-- crsdephour: integer (nullable = true)\n |-- crsdeptime: double (nullable = true)\n |-- depdelay: double (nullable = true)\n |-- crsarrtime: double (nullable = true)\n |-- arrdelay: double (nullable = true)\n |-- crselapsedtime: double (nullable = true)\n |-- dist: double (nullable = true)\n |-- orig_dest: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1550681677650_1534545106","id":"20171129-223643_463511351","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:01:18+0000","dateFinished":"2019-02-20T17:01:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53192"},{"text":"df1.select($\"orig_dest\", $\"depdelay\").filter($\"depdelay\" > 40).groupBy(\"orig_dest\").count.orderBy(desc(\"count\" )).show(5)","user":"anonymous","dateUpdated":"2019-02-20T17:01:22+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+-----+\n|orig_dest|count|\n+---------+-----+\n|  DEN_SFO|  172|\n|  ORD_SFO|  168|\n|  ATL_LGA|  155|\n|  ATL_EWR|  141|\n|  SFO_DEN|  134|\n+---------+-----+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677651_-1990312563","id":"20181004-203820_2143689992","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:01:22+0000","dateFinished":"2019-02-20T17:01:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53193"},{"text":"%md\nThe describe() function performs summary statistics calculations on  numeric columns ","user":"anonymous","dateUpdated":"2019-02-20T16:54:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>The describe() function performs summary statistics calculations on numeric columns</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1550681677651_797894956","id":"20170524-214640_973339640","dateCreated":"2019-02-20T16:54:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53194"},{"title":"Perform summary statistics  on selected columns","text":"\ndf1.describe(\"dist\", \"crselapsedtime\",\"depdelay\", \"arrdelay\").show","user":"anonymous","dateUpdated":"2019-02-20T17:01:38+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+------------------+------------------+------------------+\n|summary|              dist|    crselapsedtime|          depdelay|          arrdelay|\n+-------+------------------+------------------+------------------+------------------+\n|  count|             41348|             41348|             41348|             41348|\n|   mean|1111.0529167069749|186.26264873754474|15.018719164167553|14.806907226468027|\n| stddev| 568.7941212507527| 68.38149648990012| 44.52963204436147| 44.22370513266625|\n|    min|             184.0|              64.0|               0.0|               0.0|\n|    max|            2704.0|             423.0|            1440.0|            1442.0|\n+-------+------------------+------------------+------------------+------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677652_1627135851","id":"20170524-083228_1459810795","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:01:38+0000","dateFinished":"2019-02-20T17:01:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53195"},{"title":"Add Column for Delayed Flights and count","text":"// >= 40 minutes = delayed\nval delaybucketizer = new Bucketizer().setInputCol(\"depdelay\").setOutputCol(\"delayed\").setSplits(Array(0.0,40.0,Double.PositiveInfinity))\nval df2= delaybucketizer.transform(df1)\ndf2.cache\ndf2.groupBy(\"delayed\").count.show","user":"anonymous","dateUpdated":"2019-02-20T17:01:49+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----+\n|delayed|count|\n+-------+-----+\n|    0.0|36790|\n|    1.0| 4558|\n+-------+-----+\n\ndelaybucketizer: org.apache.spark.ml.feature.Bucketizer = bucketizer_f46815593820\ndf2: org.apache.spark.sql.DataFrame = [_id: string, dofW: int ... 12 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=4","http://ab7028547dc9:4040/jobs/job?id=5","http://ab7028547dc9:4040/jobs/job?id=6","http://ab7028547dc9:4040/jobs/job?id=7","http://ab7028547dc9:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677652_-1289724070","id":"20170524-093402_1430077788","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:01:49+0000","dateFinished":"2019-02-20T17:01:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53196"},{"title":"Register Dataset as a Temporary View in order to explore with SQL","text":"df2.createOrReplaceTempView(\"flights\")\nspark.catalog.cacheTable(\"flights\")","user":"anonymous","dateUpdated":"2019-02-20T17:01:56+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"stackedAreaChart":{}},"commonSetting":{},"keys":[{"name":"churn","index":19,"aggr":"sum"}],"groups":[],"values":[{"name":"len","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1550681677653_-1682272775","id":"20170508-150408_505244914","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:01:56+0000","dateFinished":"2019-02-20T17:01:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53197"},{"text":"%md \n# Use Spark SQL to explore the dataset","user":"anonymous","dateUpdated":"2019-02-20T17:02:51+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Use Spark SQL to explore the dataset</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1550681677653_-1644781025","id":"20170603-182655_1680505289","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:02:51+0000","dateFinished":"2019-02-20T17:02:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53198"},{"title":"Top 5 Longest departure delays","text":"%sql \nselect carrier,origin, dest, depdelay,crsdephour, dist, dofW\nfrom flights \norder by depdelay desc limit 5 \n","user":"anonymous","dateUpdated":"2019-02-20T17:02:58+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"carrier":"string","origin":"string","dest":"string","depdelay":"string","crsdephour":"string","dist":"string","dofW":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\torigin\tdest\tdepdelay\tcrsdephour\tdist\tdofW\nAA\tSFO\tORD\t1440.0\t8\t1846.0\t3\nDL\tBOS\tATL\t1185.0\t17\t946.0\t6\nUA\tDEN\tEWR\t1138.0\t12\t1605.0\t4\nDL\tORD\tATL\t1087.0\t19\t606.0\t7\nUA\tMIA\tEWR\t1072.0\t20\t1085.0\t1\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=10"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677654_1904469798","id":"20171110-195321_1924356975","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:02:59+0000","dateFinished":"2019-02-20T17:02:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53199"},{"title":"Average Departure Delay by Carrier","text":"%sql select carrier, avg(depdelay)\nfrom flights\ngroup by carrier","user":"anonymous","dateUpdated":"2019-02-20T17:28:44+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"carrier","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tavg(depdelay)\nUA\t17.477878450696764\nAA\t10.45768118831622\nDL\t15.316061660865241\nWN\t13.491000418585182\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=11","http://ab7028547dc9:4040/jobs/job?id=12","http://ab7028547dc9:4040/jobs/job?id=13","http://ab7028547dc9:4040/jobs/job?id=14","http://ab7028547dc9:4040/jobs/job?id=15"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677654_-1582585234","id":"20171110-195759_439800395","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:03:10+0000","dateFinished":"2019-02-20T17:03:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53200"},{"title":"Maximum Departure Delay by Carrier","text":"%sql\nselect carrier, max(depdelay)\nfrom flights\ngroup by carrier","user":"anonymous","dateUpdated":"2019-02-20T17:28:44+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"carrier","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"max(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tmax(depdelay)\nUA\t1138.0\nAA\t1440.0\nDL\t1185.0\nWN\t375.0\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=16","http://ab7028547dc9:4040/jobs/job?id=17","http://ab7028547dc9:4040/jobs/job?id=18","http://ab7028547dc9:4040/jobs/job?id=19","http://ab7028547dc9:4040/jobs/job?id=20"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677654_2004584996","id":"20171129-194230_774307118","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:03:17+0000","dateFinished":"2019-02-20T17:03:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53201"},{"title":"Average Departure Delay by Destination","text":"%sql\nSELECT dest, avg(depdelay) as avgdelay\nFROM flights \nGROUP BY dest\nORDER BY avgdelay desc","user":"anonymous","dateUpdated":"2019-02-20T17:28:44+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"dest","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avgdelay","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dest\tavgdelay\nSFO\t25.12807752750131\nEWR\t20.27488714659064\nLGA\t14.455166867712103\nATL\t13.588656021290753\nORD\t13.525756600128783\nDEN\t12.728005691249704\nIAH\t12.658908507223114\nBOS\t12.395548404397962\nMIA\t12.364271232259519"}]},"apps":[],"jobName":"paragraph_1550681677655_-620721159","id":"20171122-204956_303346727","dateCreated":"2019-02-20T16:54:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53202"},{"title":"Average Departure Delay by Origin","text":"%sql\nSELECT origin, avg(depdelay) as avgdelay\nFROM flights \nGROUP BY origin\nORDER BY avgdelay desc","user":"anonymous","dateUpdated":"2019-02-20T17:28:44+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"origin","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avgdelay","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"origin\tavgdelay\nSFO\t20.306176084099867\nEWR\t16.31737378525717\nDEN\t16.167720777699696\nIAH\t15.925946093111898\nORD\t14.880476190476191\nATL\t14.699547814436443\nMIA\t14.068474576271186\nBOS\t12.440173253925284\nLGA\t11.547475961538462\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=21"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677655_-763757834","id":"20171122-204822_1853914961","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:03:26+0000","dateFinished":"2019-02-20T17:03:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53203"},{"title":"Average Departure Delay by Day of the Week","text":"%sql\nSELECT dofW, avg(depdelay) as avgdelay\nFROM flights \nGROUP BY dofW\nORDER BY avgdelay desc","user":"anonymous","dateUpdated":"2019-02-20T17:28:44+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"dofW","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avgdelay","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dofW\tavgdelay\n7\t18.75420240137221\n1\t17.404697121580984\n6\t16.829883897021706\n4\t14.609846568875401\n2\t13.50552611657835\n5\t13.10193236714976\n3\t11.3646816543676\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=22"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677655_-511341549","id":"20171122-205057_803943925","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:03:32+0000","dateFinished":"2019-02-20T17:03:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53204"},{"title":"Count of Departure Delays by Day of the Week (1=Monday, 7=Sunday)","text":"%sql\nselect dofW, count(depdelay)\nfrom flights where depdelay > 40\ngroup by dofW\n","user":"anonymous","dateUpdated":"2019-02-20T17:28:44+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"dofW","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dofW\tcount(depdelay)\n1\t940\n6\t424\n3\t482\n5\t579\n4\t626\n7\t701\n2\t712\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=23","http://ab7028547dc9:4040/jobs/job?id=24","http://ab7028547dc9:4040/jobs/job?id=25","http://ab7028547dc9:4040/jobs/job?id=26","http://ab7028547dc9:4040/jobs/job?id=27"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677656_1750524802","id":"20171123-101016_2040441762","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:03:41+0000","dateFinished":"2019-02-20T17:03:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53205"},{"title":"Count of Departure Delays by Carrier (where delay=40 minutes)","text":"%sql\nselect carrier, count(delayed)\nfrom flights where delayed = 1\ngroup by carrier\norder by carrier","user":"anonymous","dateUpdated":"2019-02-20T17:28:44+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"carrier","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(delayed)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tcount(delayed)\nAA\t783\nDL\t1065\nUA\t2458\nWN\t252\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=28"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677656_592853320","id":"20171123-042011_1532799341","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:04:00+0000","dateFinished":"2019-02-20T17:04:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53206"},{"title":"Count of Delayed Not Delayed  by Carrier","text":"%sql\nSELECT delayed, count(delayed),carrier\nFROM flights\nGROUP BY carrier, delayed\norder by carrier\n","user":"anonymous","dateUpdated":"2019-02-20T17:28:44+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false,"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"carrier","index":2,"aggr":"sum"}],"groups":[{"name":"delayed","index":0,"aggr":"sum"}],"values":[{"name":"count(delayed)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"delayed\tcount(delayed)\tcarrier\n1.0\t783\tAA\n0.0\t9248\tAA\n1.0\t1065\tDL\n0.0\t8990\tDL\n0.0\t16415\tUA\n1.0\t2458\tUA\n1.0\t252\tWN\n0.0\t2137\tWN\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=29"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677656_-2112342898","id":"20170524-144751_554129160","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:04:04+0000","dateFinished":"2019-02-20T17:04:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53207"},{"title":"Count of Departure Delays by Hour of Day","text":"%sql\nselect crsdephour, count(depdelay)\nfrom flights where depdelay > 40\ngroup by crsdephour\n","user":"anonymous","dateUpdated":"2019-02-20T17:28:45+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"crsdephour","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"crsdephour\tcount(depdelay)\n12\t227\n22\t65\n1\t1\n13\t336\n16\t351\n6\t68\n20\t230\n5\t15\n19\t371\n15\t331\n9\t175\n17\t474\n8\t190\n23\t27\n7\t112\n10\t284\n24\t9\n21\t160\n11\t280\n14\t353\n0\t9\n18\t396\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=30","http://ab7028547dc9:4040/jobs/job?id=31","http://ab7028547dc9:4040/jobs/job?id=32","http://ab7028547dc9:4040/jobs/job?id=33","http://ab7028547dc9:4040/jobs/job?id=34"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677657_1081328871","id":"20171129-200107_756396508","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:04:10+0000","dateFinished":"2019-02-20T17:04:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53208"},{"title":"Count of Delayed , Not Delayed by Hour","text":"%sql\nSELECT delayed, count(delayed),crsdephour\nFROM flights\nGROUP BY crsdephour, delayed\norder by delayed","user":"anonymous","dateUpdated":"2019-02-20T17:28:45+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false,"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"crsdephour","index":2,"aggr":"sum"}],"groups":[{"name":"delayed","index":0,"aggr":"sum"}],"values":[{"name":"count(delayed)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"delayed\tcount(delayed)\tcrsdephour\n0.0\t99\t0\n0.0\t31\t1\n0.0\t2674\t10\n0.0\t3265\t7\n0.0\t2165\t14\n0.0\t2376\t13\n0.0\t1756\t19\n0.0\t170\t23\n0.0\t1352\t20\n0.0\t2400\t11\n0.0\t1891\t18\n0.0\t918\t21\n0.0\t2263\t6\n0.0\t531\t22\n0.0\t2\t2\n0.0\t2100\t16\n0.0\t2648\t8\n0.0\t160\t24\n0.0\t2204\t9\n0.0\t2019\t12\n0.0\t2876\t17\n0.0\t640\t5\n0.0\t2250\t15\n1.0\t234\t20\n1.0\t179\t9\n1.0\t27\t23\n1.0\t237\t12\n1.0\t380\t19\n1.0\t193\t8\n1.0\t164\t21\n1.0\t9\t24\n1.0\t406\t18\n1.0\t285\t11\n1.0\t66\t22\n1.0\t484\t17\n1.0\t115\t7\n1.0\t1\t1\n1.0\t345\t13\n1.0\t15\t5\n1.0\t9\t0\n1.0\t358\t14\n1.0\t355\t16\n1.0\t336\t15\n1.0\t288\t10\n1.0\t72\t6\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=35"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677657_-574612903","id":"20170524-095127_757444423","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:04:13+0000","dateFinished":"2019-02-20T17:04:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53209"},{"title":"Count of Departure Delays by Origin","text":"%sql\nselect origin, count(depdelay)\nfrom flights where depdelay > 40\ngroup by origin\nORDER BY origin","user":"anonymous","dateUpdated":"2019-02-20T17:28:45+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"origin","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"origin\tcount(depdelay)\nATL\t637\nBOS\t296\nDEN\t484\nEWR\t518\nIAH\t447\nLGA\t432\nMIA\t429\nORD\t679\nSFO\t542\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=36"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677657_-1295534141","id":"20171123-101839_1671246939","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:04:19+0000","dateFinished":"2019-02-20T17:04:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53210"},{"title":"Count of Departure Delays by Origin","text":"%sql\nSELECT delayed, count(delayed),origin\nFROM flights\nGROUP BY origin, delayed\norder by origin\n","user":"anonymous","dateUpdated":"2019-02-20T17:28:45+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"pieChart":{},"multiBarChart":{"stacked":false,"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"origin","index":2,"aggr":"sum"}],"groups":[{"name":"delayed","index":0,"aggr":"sum"}],"values":[{"name":"count(delayed)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"delayed\tcount(delayed)\torigin\n1.0\t649\tATL\n0.0\t5322\tATL\n1.0\t306\tBOS\n0.0\t3388\tBOS\n0.0\t3773\tDEN\n1.0\t496\tDEN\n1.0\t526\tEWR\n0.0\t3693\tEWR\n0.0\t3218\tIAH\n1.0\t455\tIAH\n1.0\t442\tLGA\n0.0\t4550\tLGA\n0.0\t3991\tMIA\n1.0\t434\tMIA\n1.0\t693\tORD\n0.0\t5607\tORD\n1.0\t557\tSFO\n0.0\t3248\tSFO\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=37"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677658_457136829","id":"20171110-211045_792848918","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:04:24+0000","dateFinished":"2019-02-20T17:04:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53211"},{"title":"Count of Departure Delays by Destination","text":"%sql\nselect dest, count(delayed)\nfrom flights where delayed = 1\ngroup by dest\nORDER BY dest\n","user":"anonymous","dateUpdated":"2019-02-20T17:28:45+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"dest","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(delayed)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dest\tcount(delayed)\nATL\t557\nBOS\t351\nDEN\t411\nEWR\t631\nIAH\t338\nLGA\t545\nMIA\t392\nORD\t613\nSFO\t720\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=38"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677658_-1105770556","id":"20171123-102221_687729087","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:04:27+0000","dateFinished":"2019-02-20T17:04:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53212"},{"title":"Count of Delayed not Delayed by Destination","text":"%sql\nSELECT delayed, count(delayed),dest\nFROM flights\nGROUP BY dest, delayed\norder by dest","user":"anonymous","dateUpdated":"2019-02-20T17:28:45+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"dest","index":2,"aggr":"sum"}],"groups":[{"name":"delayed","index":0,"aggr":"sum"}],"values":[{"name":"count(delayed)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"delayed\tcount(delayed)\tdest\n0.0\t5455\tATL\n1.0\t557\tATL\n1.0\t351\tBOS\n0.0\t3378\tBOS\n1.0\t411\tDEN\n0.0\t3806\tDEN\n0.0\t3578\tEWR\n1.0\t631\tEWR\n1.0\t338\tIAH\n0.0\t3400\tIAH\n0.0\t4429\tLGA\n1.0\t545\tLGA\n1.0\t392\tMIA\n0.0\t4047\tMIA\n1.0\t613\tORD\n0.0\t5599\tORD\n0.0\t3098\tSFO\n1.0\t720\tSFO\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=39"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677658_-1149409245","id":"20171122-211508_2036968500","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:04:36+0000","dateFinished":"2019-02-20T17:04:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53213"},{"title":"Count of Departure Delays by Origin, Destination","text":"%sql\nselect origin, dest, count(depdelay)\nfrom flights where depdelay > 40\ngroup by origin, dest\nORDER BY count(depdelay) desc\n","user":"anonymous","dateUpdated":"2019-02-20T17:28:45+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"origin","index":0,"aggr":"sum"}],"groups":[{"name":"dest","index":1,"aggr":"sum"}],"values":[{"name":"count(depdelay)","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"origin\tdest\tcount(depdelay)\nDEN\tSFO\t172\nORD\tSFO\t168\nATL\tLGA\t155\nATL\tEWR\t141\nSFO\tDEN\t134\nLGA\tATL\t130\nORD\tEWR\t122\nSFO\tORD\t118\nEWR\tORD\t115\nORD\tLGA\t100\nIAH\tSFO\t98\nIAH\tEWR\t94\nMIA\tLGA\t92\nORD\tATL\t88\nLGA\tORD\t88\nATL\tSFO\t87\nLGA\tMIA\t81\nSFO\tEWR\t79\nEWR\tSFO\t77\nEWR\tATL\t76\nORD\tDEN\t76\nEWR\tIAH\t75\nATL\tORD\t74\nDEN\tEWR\t73\nEWR\tMIA\t69\nLGA\tBOS\t67\nEWR\tBOS\t67\nDEN\tLGA\t67\nATL\tMIA\t66\nMIA\tEWR\t66\nMIA\tATL\t64\nBOS\tLGA\t62\nSFO\tIAH\t62\nSFO\tATL\t59\nIAH\tLGA\t59\nMIA\tSFO\t57\nDEN\tORD\t57\nIAH\tMIA\t57\nMIA\tIAH\t55\nDEN\tATL\t54\nSFO\tBOS\t52\nBOS\tSFO\t52\nMIA\tORD\t50\nBOS\tATL\t49\nIAH\tORD\t48\nORD\tBOS\t46\nIAH\tDEN\t46\nATL\tBOS\t46\nBOS\tEWR\t45\nBOS\tORD\t43\nORD\tMIA\t43\nATL\tDEN\t43\nEWR\tDEN\t39\nDEN\tIAH\t39\nSFO\tMIA\t38\nORD\tIAH\t36\nLGA\tDEN\t35\nMIA\tBOS\t32\nLGA\tIAH\t31\nIAH\tATL\t27\nATL\tIAH\t25\nBOS\tMIA\t24\nIAH\tBOS\t18\nDEN\tBOS\t15\nMIA\tDEN\t13\nBOS\tDEN\t11\nBOS\tIAH\t10\nDEN\tMIA\t7\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=40"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677659_-1382464539","id":"20171123-102627_1669385618","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:04:45+0000","dateFinished":"2019-02-20T17:04:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53214"},{"title":"Stratify the sampling to fewer Not Delayed","text":"val testData = df2\n// keep all delayed , keep 13% not delayed\nval fractions = Map(0.0 -> .13, 1.0->1.0) // \nval trainingData =df2.stat.sampleBy(\"delayed\", fractions, 36L)\n\n\ntrainingData.createOrReplaceTempView(\"flights\")\ntrainingData.groupBy(\"delayed\").count.show\n","user":"anonymous","dateUpdated":"2019-02-20T17:05:07+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----+\n|delayed|count|\n+-------+-----+\n|    0.0| 4775|\n|    1.0| 4558|\n+-------+-----+\n\ntestData: org.apache.spark.sql.DataFrame = [_id: string, dofW: int ... 12 more fields]\nfractions: scala.collection.immutable.Map[Double,Double] = Map(0.0 -> 0.13, 1.0 -> 1.0)\ntrainingData: org.apache.spark.sql.DataFrame = [_id: string, dofW: int ... 12 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=41","http://ab7028547dc9:4040/jobs/job?id=42","http://ab7028547dc9:4040/jobs/job?id=43","http://ab7028547dc9:4040/jobs/job?id=44","http://ab7028547dc9:4040/jobs/job?id=45"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677659_-958153095","id":"20171123-050717_1328190278","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:05:07+0000","dateFinished":"2019-02-20T17:05:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53215"},{"text":"%md\n## Handling Text Features\nIn order for the features to be used by a machine learning algorithm, they are transformed into numbers representing the value for each feature. Use a StringIndexer to convert the categorical variables in the dataset into numeric variables\n","user":"anonymous","dateUpdated":"2019-02-20T17:07:32+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Handling Text Features</h2>\n<p>In order for the features to be used by a machine learning algorithm, they are transformed into numbers representing the value for each feature. Use a StringIndexer to convert the categorical variables in the dataset into numeric variables</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1550681677659_-1343134684","id":"20170603-184811_78732818","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:07:32+0000","dateFinished":"2019-02-20T17:07:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53216"},{"title":"Use a StringIndexer  to encode categorical columns","text":"// categorical Column names\nval categoricalColumns = Array(\"carrier\", \"origin\", \"dest\", \"dofW\", \"orig_dest\")\n\n// String Indexers will encode string categorial columns into a column numeric indices\nval stringIndexers = categoricalColumns.map { colName =>\n      new StringIndexer()\n        .setInputCol(colName)\n        .setOutputCol(colName + \"Indexed\")\n        .fit(trainingData)\n}\n\n","user":"anonymous","dateUpdated":"2019-02-20T17:07:40+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"categoricalColumns: Array[String] = Array(carrier, origin, dest, dofW, orig_dest)\nstringIndexers: Array[org.apache.spark.ml.feature.StringIndexerModel] = Array(strIdx_23237f6f34c0, strIdx_e846fd199322, strIdx_dc48b69400b5, strIdx_aad440b40106, strIdx_2554a2425faa)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=46","http://ab7028547dc9:4040/jobs/job?id=47","http://ab7028547dc9:4040/jobs/job?id=48","http://ab7028547dc9:4040/jobs/job?id=49","http://ab7028547dc9:4040/jobs/job?id=50"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677660_609880218","id":"20170508-150543_958647761","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:07:40+0000","dateFinished":"2019-02-20T17:07:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53217"},{"title":"Use VectorAssembler, a transformer,  to put features into a feature vector column","text":"//bucket the dataset into delayed and not delayed flights with a label 0/1 column \nval labeler = new Bucketizer().setInputCol(\"depdelay\").setOutputCol(\"label\").setSplits(Array( 0.0, 40.0, Double.PositiveInfinity))\n\nval featureCols = Array(\"carrierIndexed\", \"destIndexed\", \"originIndexed\", \"dofWIndexed\", \"orig_destIndexed\",\"crsdephour\", \"crsdeptime\", \"crsarrtime\",\"crselapsedtime\", \"dist\")\n\n//put features into a feature vector column   \nval assembler = new VectorAssembler().setInputCols(featureCols).setOutputCol(\"features\")\n","user":"anonymous","dateUpdated":"2019-02-20T17:07:48+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"labeler: org.apache.spark.ml.feature.Bucketizer = bucketizer_60d2b0b00b4b\nfeatureCols: Array[String] = Array(carrierIndexed, destIndexed, originIndexed, dofWIndexed, orig_destIndexed, crsdephour, crsdeptime, crsarrtime, crselapsedtime, dist)\nassembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_bad708c013bb\n"}]},"apps":[],"jobName":"paragraph_1550681677660_1835386655","id":"20170524-223310_2121058884","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:07:48+0000","dateFinished":"2019-02-20T17:07:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53218"},{"title":"Create Random Forest Estimator , set Label and Feature Columns ","text":"val rf = new RandomForestClassifier().setLabelCol(\"label\").setFeaturesCol(\"features\")     ","user":"anonymous","dateUpdated":"2019-02-20T17:09:41+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"rf: org.apache.spark.ml.classification.RandomForestClassifier = rfc_ac7eebf816e9\n"}]},"apps":[],"jobName":"paragraph_1550681677661_790878157","id":"20170603-185445_276463997","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:09:41+0000","dateFinished":"2019-02-20T17:09:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53219"},{"text":"%md\n## Setup Spark ML pipeline stages\nSet up a pipeline to pass the data through transformers to extract the features and label and pass this to a decision tree estimator to fit the model \n\n","user":"anonymous","dateUpdated":"2019-02-20T17:11:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Setup Spark ML pipeline stages</h2>\n<p>Set up a pipeline to pass the data through transformers to extract the features and label and pass this to a decision tree estimator to fit the model</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1550681677661_-571073313","id":"20170601-154525_1033166149","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:11:09+0000","dateFinished":"2019-02-20T17:11:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53220"},{"title":"Set up pipeline with  feature transformers and model estimator","text":"val steps = stringIndexers ++ Array(labeler, assembler, rf)\nval pipeline = new Pipeline().setStages(steps)\n","user":"anonymous","dateUpdated":"2019-02-20T17:09:48+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"steps: Array[org.apache.spark.ml.PipelineStage with org.apache.spark.ml.util.MLWritable{def copy(extra: org.apache.spark.ml.param.ParamMap): org.apache.spark.ml.PipelineStage with org.apache.spark.ml.util.MLWritable{def copy(extra: org.apache.spark.ml.param.ParamMap): org.apache.spark.ml.PipelineStage with org.apache.spark.ml.util.MLWritable}}] = Array(strIdx_23237f6f34c0, strIdx_e846fd199322, strIdx_dc48b69400b5, strIdx_aad440b40106, strIdx_2554a2425faa, bucketizer_60d2b0b00b4b, vecAssembler_bad708c013bb, rfc_ac7eebf816e9)\npipeline: org.apache.spark.ml.Pipeline = pipeline_c6c5d6e2645e\n"}]},"apps":[],"jobName":"paragraph_1550681677661_604029811","id":"20170508-151557_1422077156","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:09:48+0000","dateFinished":"2019-02-20T17:09:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53221"},{"text":"%md\r\n## Better Evaluation using Cross-Validation\r\nSpark ML supports k-fold cross validation with a transformation/estimation pipeline to try out different combinations of parameters, using a process called grid search. You set up a CrossValidator with the parameters to test, an estimator and evaluator for a model selection workflow.\r\n","user":"anonymous","dateUpdated":"2019-02-20T17:14:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Better Evaluation using Cross-Validation</h2>\n<p>Spark ML supports k-fold cross validation with a transformation/estimation pipeline to try out different combinations of parameters, using a process called grid search. You set up a CrossValidator with the parameters to test, an estimator and evaluator for a model selection workflow.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1550681677661_1342461436","id":"20170531-154658_1298817002","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:14:35+0000","dateFinished":"2019-02-20T17:14:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53222"},{"title":"Set up a CrossValidator with the parameters, a tree estimator and evaluator","text":"// set param grid to Search through RF parameters for best model\n// Deeper trees are potentially more accurate, but are also more likely to overfit.\n\nval paramGrid = new ParamGridBuilder().addGrid(rf.maxBins, Array(100, 200)).addGrid(rf.maxDepth, Array(2, 4, 10)).addGrid(rf.numTrees, Array(5, 20)).addGrid(rf.impurity, Array(\"entropy\", \"gini\")).build()\n \nval evaluator = new BinaryClassificationEvaluator()  \n\n// Set up 3-fold cross validation with paramGrid\nval crossvalidator = new CrossValidator().setEstimator(pipeline).setEvaluator (evaluator).setEstimatorParamMaps(paramGrid).setNumFolds(3)","user":"anonymous","dateUpdated":"2019-02-20T17:11:33+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"paramGrid: Array[org.apache.spark.ml.param.ParamMap] =\nArray({\n\trfc_ac7eebf816e9-impurity: entropy,\n\trfc_ac7eebf816e9-maxBins: 100,\n\trfc_ac7eebf816e9-maxDepth: 2,\n\trfc_ac7eebf816e9-numTrees: 5\n}, {\n\trfc_ac7eebf816e9-impurity: entropy,\n\trfc_ac7eebf816e9-maxBins: 100,\n\trfc_ac7eebf816e9-maxDepth: 4,\n\trfc_ac7eebf816e9-numTrees: 5\n}, {\n\trfc_ac7eebf816e9-impurity: entropy,\n\trfc_ac7eebf816e9-maxBins: 100,\n\trfc_ac7eebf816e9-maxDepth: 10,\n\trfc_ac7eebf816e9-numTrees: 5\n}, {\n\trfc_ac7eebf816e9-impurity: gini,\n\trfc_ac7eebf816e9-maxBins: 100,\n\trfc_ac7eebf816e9-maxDepth: 2,\n\trfc_ac7eebf816e9-numTrees: 5\n}, {\n\trfc_ac7eebf816e9-impurity: gini,\n\trfc_ac7eebf816e9-maxBins: 100,\n\trfc_ac7eebf816e9-maxDepth: 4,\n\trfc_ac7eebf816e9-numTrees: 5\n}, {\n\trfc_ac7eebf816e9-impurity: gini,\n\trfc_ac7eebf816e9-maxBins: 100..."}]},"apps":[],"jobName":"paragraph_1550681677662_-930598507","id":"20170508-151903_1365343172","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:11:33+0000","dateFinished":"2019-02-20T17:11:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53223"},{"title":"Train the Model","text":"val pipelineModel = crossvalidator.fit(trainingData)","user":"anonymous","dateUpdated":"2019-02-20T17:14:44+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pipelineModel: org.apache.spark.ml.tuning.CrossValidatorModel = cv_1d8ba8e9c680\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=51","http://ab7028547dc9:4040/jobs/job?id=52","http://ab7028547dc9:4040/jobs/job?id=53","http://ab7028547dc9:4040/jobs/job?id=54","http://ab7028547dc9:4040/jobs/job?id=55","http://ab7028547dc9:4040/jobs/job?id=56","http://ab7028547dc9:4040/jobs/job?id=57","http://ab7028547dc9:4040/jobs/job?id=58","http://ab7028547dc9:4040/jobs/job?id=59","http://ab7028547dc9:4040/jobs/job?id=60","http://ab7028547dc9:4040/jobs/job?id=61","http://ab7028547dc9:4040/jobs/job?id=62","http://ab7028547dc9:4040/jobs/job?id=63","http://ab7028547dc9:4040/jobs/job?id=64","http://ab7028547dc9:4040/jobs/job?id=65","http://ab7028547dc9:4040/jobs/job?id=66","http://ab7028547dc9:4040/jobs/job?id=67","http://ab7028547dc9:4040/jobs/job?id=68","http://ab7028547dc9:4040/jobs/job?id=69","http://ab7028547dc9:4040/jobs/job?id=70","http://ab7028547dc9:4040/jobs/job?id=71","http://ab7028547dc9:4040/jobs/job?id=72","http://ab7028547dc9:4040/jobs/job?id=73","http://ab7028547dc9:4040/jobs/job?id=74","http://ab7028547dc9:4040/jobs/job?id=75","http://ab7028547dc9:4040/jobs/job?id=76","http://ab7028547dc9:4040/jobs/job?id=77","http://ab7028547dc9:4040/jobs/job?id=78","http://ab7028547dc9:4040/jobs/job?id=79","http://ab7028547dc9:4040/jobs/job?id=80","http://ab7028547dc9:4040/jobs/job?id=81","http://ab7028547dc9:4040/jobs/job?id=82","http://ab7028547dc9:4040/jobs/job?id=83","http://ab7028547dc9:4040/jobs/job?id=84","http://ab7028547dc9:4040/jobs/job?id=85","http://ab7028547dc9:4040/jobs/job?id=86","http://ab7028547dc9:4040/jobs/job?id=87","http://ab7028547dc9:4040/jobs/job?id=88","http://ab7028547dc9:4040/jobs/job?id=89","http://ab7028547dc9:4040/jobs/job?id=90","http://ab7028547dc9:4040/jobs/job?id=91","http://ab7028547dc9:4040/jobs/job?id=92","http://ab7028547dc9:4040/jobs/job?id=93","http://ab7028547dc9:4040/jobs/job?id=94","http://ab7028547dc9:4040/jobs/job?id=95","http://ab7028547dc9:4040/jobs/job?id=96","http://ab7028547dc9:4040/jobs/job?id=97","http://ab7028547dc9:4040/jobs/job?id=98","http://ab7028547dc9:4040/jobs/job?id=99","http://ab7028547dc9:4040/jobs/job?id=100","http://ab7028547dc9:4040/jobs/job?id=101","http://ab7028547dc9:4040/jobs/job?id=102","http://ab7028547dc9:4040/jobs/job?id=103","http://ab7028547dc9:4040/jobs/job?id=104","http://ab7028547dc9:4040/jobs/job?id=105","http://ab7028547dc9:4040/jobs/job?id=106","http://ab7028547dc9:4040/jobs/job?id=107","http://ab7028547dc9:4040/jobs/job?id=108","http://ab7028547dc9:4040/jobs/job?id=109","http://ab7028547dc9:4040/jobs/job?id=110","http://ab7028547dc9:4040/jobs/job?id=111","http://ab7028547dc9:4040/jobs/job?id=112","http://ab7028547dc9:4040/jobs/job?id=113","http://ab7028547dc9:4040/jobs/job?id=114","http://ab7028547dc9:4040/jobs/job?id=115","http://ab7028547dc9:4040/jobs/job?id=116","http://ab7028547dc9:4040/jobs/job?id=117","http://ab7028547dc9:4040/jobs/job?id=118","http://ab7028547dc9:4040/jobs/job?id=119","http://ab7028547dc9:4040/jobs/job?id=120","http://ab7028547dc9:4040/jobs/job?id=121","http://ab7028547dc9:4040/jobs/job?id=122","http://ab7028547dc9:4040/jobs/job?id=123","http://ab7028547dc9:4040/jobs/job?id=124","http://ab7028547dc9:4040/jobs/job?id=125","http://ab7028547dc9:4040/jobs/job?id=126","http://ab7028547dc9:4040/jobs/job?id=127","http://ab7028547dc9:4040/jobs/job?id=128","http://ab7028547dc9:4040/jobs/job?id=129","http://ab7028547dc9:4040/jobs/job?id=130","http://ab7028547dc9:4040/jobs/job?id=131","http://ab7028547dc9:4040/jobs/job?id=132","http://ab7028547dc9:4040/jobs/job?id=133","http://ab7028547dc9:4040/jobs/job?id=134","http://ab7028547dc9:4040/jobs/job?id=135","http://ab7028547dc9:4040/jobs/job?id=136","http://ab7028547dc9:4040/jobs/job?id=137","http://ab7028547dc9:4040/jobs/job?id=138","http://ab7028547dc9:4040/jobs/job?id=139","http://ab7028547dc9:4040/jobs/job?id=140","http://ab7028547dc9:4040/jobs/job?id=141","http://ab7028547dc9:4040/jobs/job?id=142","http://ab7028547dc9:4040/jobs/job?id=143","http://ab7028547dc9:4040/jobs/job?id=144","http://ab7028547dc9:4040/jobs/job?id=145","http://ab7028547dc9:4040/jobs/job?id=146","http://ab7028547dc9:4040/jobs/job?id=147","http://ab7028547dc9:4040/jobs/job?id=148","http://ab7028547dc9:4040/jobs/job?id=149","http://ab7028547dc9:4040/jobs/job?id=150","http://ab7028547dc9:4040/jobs/job?id=151","http://ab7028547dc9:4040/jobs/job?id=152","http://ab7028547dc9:4040/jobs/job?id=153","http://ab7028547dc9:4040/jobs/job?id=154","http://ab7028547dc9:4040/jobs/job?id=155","http://ab7028547dc9:4040/jobs/job?id=156","http://ab7028547dc9:4040/jobs/job?id=157","http://ab7028547dc9:4040/jobs/job?id=158","http://ab7028547dc9:4040/jobs/job?id=159","http://ab7028547dc9:4040/jobs/job?id=160","http://ab7028547dc9:4040/jobs/job?id=161","http://ab7028547dc9:4040/jobs/job?id=162","http://ab7028547dc9:4040/jobs/job?id=163","http://ab7028547dc9:4040/jobs/job?id=164","http://ab7028547dc9:4040/jobs/job?id=165","http://ab7028547dc9:4040/jobs/job?id=166","http://ab7028547dc9:4040/jobs/job?id=167","http://ab7028547dc9:4040/jobs/job?id=168","http://ab7028547dc9:4040/jobs/job?id=169","http://ab7028547dc9:4040/jobs/job?id=170","http://ab7028547dc9:4040/jobs/job?id=171","http://ab7028547dc9:4040/jobs/job?id=172","http://ab7028547dc9:4040/jobs/job?id=173","http://ab7028547dc9:4040/jobs/job?id=174","http://ab7028547dc9:4040/jobs/job?id=175","http://ab7028547dc9:4040/jobs/job?id=176","http://ab7028547dc9:4040/jobs/job?id=177","http://ab7028547dc9:4040/jobs/job?id=178","http://ab7028547dc9:4040/jobs/job?id=179","http://ab7028547dc9:4040/jobs/job?id=180","http://ab7028547dc9:4040/jobs/job?id=181","http://ab7028547dc9:4040/jobs/job?id=182","http://ab7028547dc9:4040/jobs/job?id=183","http://ab7028547dc9:4040/jobs/job?id=184","http://ab7028547dc9:4040/jobs/job?id=185","http://ab7028547dc9:4040/jobs/job?id=186","http://ab7028547dc9:4040/jobs/job?id=187","http://ab7028547dc9:4040/jobs/job?id=188","http://ab7028547dc9:4040/jobs/job?id=189","http://ab7028547dc9:4040/jobs/job?id=190","http://ab7028547dc9:4040/jobs/job?id=191","http://ab7028547dc9:4040/jobs/job?id=192","http://ab7028547dc9:4040/jobs/job?id=193","http://ab7028547dc9:4040/jobs/job?id=194","http://ab7028547dc9:4040/jobs/job?id=195","http://ab7028547dc9:4040/jobs/job?id=196","http://ab7028547dc9:4040/jobs/job?id=197","http://ab7028547dc9:4040/jobs/job?id=198","http://ab7028547dc9:4040/jobs/job?id=199","http://ab7028547dc9:4040/jobs/job?id=200","http://ab7028547dc9:4040/jobs/job?id=201","http://ab7028547dc9:4040/jobs/job?id=202","http://ab7028547dc9:4040/jobs/job?id=203","http://ab7028547dc9:4040/jobs/job?id=204","http://ab7028547dc9:4040/jobs/job?id=205","http://ab7028547dc9:4040/jobs/job?id=206","http://ab7028547dc9:4040/jobs/job?id=207","http://ab7028547dc9:4040/jobs/job?id=208","http://ab7028547dc9:4040/jobs/job?id=209","http://ab7028547dc9:4040/jobs/job?id=210","http://ab7028547dc9:4040/jobs/job?id=211","http://ab7028547dc9:4040/jobs/job?id=212","http://ab7028547dc9:4040/jobs/job?id=213","http://ab7028547dc9:4040/jobs/job?id=214","http://ab7028547dc9:4040/jobs/job?id=215","http://ab7028547dc9:4040/jobs/job?id=216","http://ab7028547dc9:4040/jobs/job?id=217","http://ab7028547dc9:4040/jobs/job?id=218","http://ab7028547dc9:4040/jobs/job?id=219","http://ab7028547dc9:4040/jobs/job?id=220","http://ab7028547dc9:4040/jobs/job?id=221","http://ab7028547dc9:4040/jobs/job?id=222","http://ab7028547dc9:4040/jobs/job?id=223","http://ab7028547dc9:4040/jobs/job?id=224","http://ab7028547dc9:4040/jobs/job?id=225","http://ab7028547dc9:4040/jobs/job?id=226","http://ab7028547dc9:4040/jobs/job?id=227","http://ab7028547dc9:4040/jobs/job?id=228","http://ab7028547dc9:4040/jobs/job?id=229","http://ab7028547dc9:4040/jobs/job?id=230","http://ab7028547dc9:4040/jobs/job?id=231","http://ab7028547dc9:4040/jobs/job?id=232","http://ab7028547dc9:4040/jobs/job?id=233","http://ab7028547dc9:4040/jobs/job?id=234","http://ab7028547dc9:4040/jobs/job?id=235","http://ab7028547dc9:4040/jobs/job?id=236","http://ab7028547dc9:4040/jobs/job?id=237","http://ab7028547dc9:4040/jobs/job?id=238","http://ab7028547dc9:4040/jobs/job?id=239","http://ab7028547dc9:4040/jobs/job?id=240","http://ab7028547dc9:4040/jobs/job?id=241","http://ab7028547dc9:4040/jobs/job?id=242","http://ab7028547dc9:4040/jobs/job?id=243","http://ab7028547dc9:4040/jobs/job?id=244","http://ab7028547dc9:4040/jobs/job?id=245","http://ab7028547dc9:4040/jobs/job?id=246","http://ab7028547dc9:4040/jobs/job?id=247","http://ab7028547dc9:4040/jobs/job?id=248","http://ab7028547dc9:4040/jobs/job?id=249","http://ab7028547dc9:4040/jobs/job?id=250","http://ab7028547dc9:4040/jobs/job?id=251","http://ab7028547dc9:4040/jobs/job?id=252","http://ab7028547dc9:4040/jobs/job?id=253","http://ab7028547dc9:4040/jobs/job?id=254","http://ab7028547dc9:4040/jobs/job?id=255","http://ab7028547dc9:4040/jobs/job?id=256","http://ab7028547dc9:4040/jobs/job?id=257","http://ab7028547dc9:4040/jobs/job?id=258","http://ab7028547dc9:4040/jobs/job?id=259","http://ab7028547dc9:4040/jobs/job?id=260","http://ab7028547dc9:4040/jobs/job?id=261","http://ab7028547dc9:4040/jobs/job?id=262","http://ab7028547dc9:4040/jobs/job?id=263","http://ab7028547dc9:4040/jobs/job?id=264","http://ab7028547dc9:4040/jobs/job?id=265","http://ab7028547dc9:4040/jobs/job?id=266","http://ab7028547dc9:4040/jobs/job?id=267","http://ab7028547dc9:4040/jobs/job?id=268","http://ab7028547dc9:4040/jobs/job?id=269","http://ab7028547dc9:4040/jobs/job?id=270","http://ab7028547dc9:4040/jobs/job?id=271","http://ab7028547dc9:4040/jobs/job?id=272","http://ab7028547dc9:4040/jobs/job?id=273","http://ab7028547dc9:4040/jobs/job?id=274","http://ab7028547dc9:4040/jobs/job?id=275","http://ab7028547dc9:4040/jobs/job?id=276","http://ab7028547dc9:4040/jobs/job?id=277","http://ab7028547dc9:4040/jobs/job?id=278","http://ab7028547dc9:4040/jobs/job?id=279","http://ab7028547dc9:4040/jobs/job?id=280","http://ab7028547dc9:4040/jobs/job?id=281","http://ab7028547dc9:4040/jobs/job?id=282","http://ab7028547dc9:4040/jobs/job?id=283","http://ab7028547dc9:4040/jobs/job?id=284","http://ab7028547dc9:4040/jobs/job?id=285","http://ab7028547dc9:4040/jobs/job?id=286","http://ab7028547dc9:4040/jobs/job?id=287","http://ab7028547dc9:4040/jobs/job?id=288","http://ab7028547dc9:4040/jobs/job?id=289","http://ab7028547dc9:4040/jobs/job?id=290","http://ab7028547dc9:4040/jobs/job?id=291","http://ab7028547dc9:4040/jobs/job?id=292","http://ab7028547dc9:4040/jobs/job?id=293","http://ab7028547dc9:4040/jobs/job?id=294","http://ab7028547dc9:4040/jobs/job?id=295","http://ab7028547dc9:4040/jobs/job?id=296","http://ab7028547dc9:4040/jobs/job?id=297","http://ab7028547dc9:4040/jobs/job?id=298","http://ab7028547dc9:4040/jobs/job?id=299","http://ab7028547dc9:4040/jobs/job?id=300","http://ab7028547dc9:4040/jobs/job?id=301","http://ab7028547dc9:4040/jobs/job?id=302","http://ab7028547dc9:4040/jobs/job?id=303","http://ab7028547dc9:4040/jobs/job?id=304","http://ab7028547dc9:4040/jobs/job?id=305","http://ab7028547dc9:4040/jobs/job?id=306","http://ab7028547dc9:4040/jobs/job?id=307","http://ab7028547dc9:4040/jobs/job?id=308","http://ab7028547dc9:4040/jobs/job?id=309","http://ab7028547dc9:4040/jobs/job?id=310","http://ab7028547dc9:4040/jobs/job?id=311","http://ab7028547dc9:4040/jobs/job?id=312","http://ab7028547dc9:4040/jobs/job?id=313","http://ab7028547dc9:4040/jobs/job?id=314","http://ab7028547dc9:4040/jobs/job?id=315","http://ab7028547dc9:4040/jobs/job?id=316","http://ab7028547dc9:4040/jobs/job?id=317","http://ab7028547dc9:4040/jobs/job?id=318","http://ab7028547dc9:4040/jobs/job?id=319","http://ab7028547dc9:4040/jobs/job?id=320","http://ab7028547dc9:4040/jobs/job?id=321","http://ab7028547dc9:4040/jobs/job?id=322","http://ab7028547dc9:4040/jobs/job?id=323","http://ab7028547dc9:4040/jobs/job?id=324","http://ab7028547dc9:4040/jobs/job?id=325","http://ab7028547dc9:4040/jobs/job?id=326","http://ab7028547dc9:4040/jobs/job?id=327","http://ab7028547dc9:4040/jobs/job?id=328","http://ab7028547dc9:4040/jobs/job?id=329","http://ab7028547dc9:4040/jobs/job?id=330","http://ab7028547dc9:4040/jobs/job?id=331","http://ab7028547dc9:4040/jobs/job?id=332","http://ab7028547dc9:4040/jobs/job?id=333","http://ab7028547dc9:4040/jobs/job?id=334","http://ab7028547dc9:4040/jobs/job?id=335","http://ab7028547dc9:4040/jobs/job?id=336","http://ab7028547dc9:4040/jobs/job?id=337","http://ab7028547dc9:4040/jobs/job?id=338","http://ab7028547dc9:4040/jobs/job?id=339","http://ab7028547dc9:4040/jobs/job?id=340","http://ab7028547dc9:4040/jobs/job?id=341","http://ab7028547dc9:4040/jobs/job?id=342","http://ab7028547dc9:4040/jobs/job?id=343","http://ab7028547dc9:4040/jobs/job?id=344","http://ab7028547dc9:4040/jobs/job?id=345","http://ab7028547dc9:4040/jobs/job?id=346","http://ab7028547dc9:4040/jobs/job?id=347","http://ab7028547dc9:4040/jobs/job?id=348","http://ab7028547dc9:4040/jobs/job?id=349","http://ab7028547dc9:4040/jobs/job?id=350","http://ab7028547dc9:4040/jobs/job?id=351","http://ab7028547dc9:4040/jobs/job?id=352","http://ab7028547dc9:4040/jobs/job?id=353","http://ab7028547dc9:4040/jobs/job?id=354","http://ab7028547dc9:4040/jobs/job?id=355","http://ab7028547dc9:4040/jobs/job?id=356","http://ab7028547dc9:4040/jobs/job?id=357","http://ab7028547dc9:4040/jobs/job?id=358","http://ab7028547dc9:4040/jobs/job?id=359","http://ab7028547dc9:4040/jobs/job?id=360","http://ab7028547dc9:4040/jobs/job?id=361","http://ab7028547dc9:4040/jobs/job?id=362","http://ab7028547dc9:4040/jobs/job?id=363","http://ab7028547dc9:4040/jobs/job?id=364","http://ab7028547dc9:4040/jobs/job?id=365","http://ab7028547dc9:4040/jobs/job?id=366","http://ab7028547dc9:4040/jobs/job?id=367","http://ab7028547dc9:4040/jobs/job?id=368","http://ab7028547dc9:4040/jobs/job?id=369","http://ab7028547dc9:4040/jobs/job?id=370","http://ab7028547dc9:4040/jobs/job?id=371","http://ab7028547dc9:4040/jobs/job?id=372","http://ab7028547dc9:4040/jobs/job?id=373","http://ab7028547dc9:4040/jobs/job?id=374","http://ab7028547dc9:4040/jobs/job?id=375","http://ab7028547dc9:4040/jobs/job?id=376","http://ab7028547dc9:4040/jobs/job?id=377","http://ab7028547dc9:4040/jobs/job?id=378","http://ab7028547dc9:4040/jobs/job?id=379","http://ab7028547dc9:4040/jobs/job?id=380","http://ab7028547dc9:4040/jobs/job?id=381","http://ab7028547dc9:4040/jobs/job?id=382","http://ab7028547dc9:4040/jobs/job?id=383","http://ab7028547dc9:4040/jobs/job?id=384","http://ab7028547dc9:4040/jobs/job?id=385","http://ab7028547dc9:4040/jobs/job?id=386","http://ab7028547dc9:4040/jobs/job?id=387","http://ab7028547dc9:4040/jobs/job?id=388","http://ab7028547dc9:4040/jobs/job?id=389","http://ab7028547dc9:4040/jobs/job?id=390","http://ab7028547dc9:4040/jobs/job?id=391","http://ab7028547dc9:4040/jobs/job?id=392","http://ab7028547dc9:4040/jobs/job?id=393","http://ab7028547dc9:4040/jobs/job?id=394","http://ab7028547dc9:4040/jobs/job?id=395","http://ab7028547dc9:4040/jobs/job?id=396","http://ab7028547dc9:4040/jobs/job?id=397","http://ab7028547dc9:4040/jobs/job?id=398","http://ab7028547dc9:4040/jobs/job?id=399","http://ab7028547dc9:4040/jobs/job?id=400","http://ab7028547dc9:4040/jobs/job?id=401","http://ab7028547dc9:4040/jobs/job?id=402","http://ab7028547dc9:4040/jobs/job?id=403","http://ab7028547dc9:4040/jobs/job?id=404","http://ab7028547dc9:4040/jobs/job?id=405","http://ab7028547dc9:4040/jobs/job?id=406","http://ab7028547dc9:4040/jobs/job?id=407","http://ab7028547dc9:4040/jobs/job?id=408","http://ab7028547dc9:4040/jobs/job?id=409","http://ab7028547dc9:4040/jobs/job?id=410","http://ab7028547dc9:4040/jobs/job?id=411","http://ab7028547dc9:4040/jobs/job?id=412","http://ab7028547dc9:4040/jobs/job?id=413","http://ab7028547dc9:4040/jobs/job?id=414","http://ab7028547dc9:4040/jobs/job?id=415","http://ab7028547dc9:4040/jobs/job?id=416","http://ab7028547dc9:4040/jobs/job?id=417","http://ab7028547dc9:4040/jobs/job?id=418","http://ab7028547dc9:4040/jobs/job?id=419","http://ab7028547dc9:4040/jobs/job?id=420","http://ab7028547dc9:4040/jobs/job?id=421","http://ab7028547dc9:4040/jobs/job?id=422","http://ab7028547dc9:4040/jobs/job?id=423","http://ab7028547dc9:4040/jobs/job?id=424","http://ab7028547dc9:4040/jobs/job?id=425","http://ab7028547dc9:4040/jobs/job?id=426","http://ab7028547dc9:4040/jobs/job?id=427","http://ab7028547dc9:4040/jobs/job?id=428","http://ab7028547dc9:4040/jobs/job?id=429","http://ab7028547dc9:4040/jobs/job?id=430","http://ab7028547dc9:4040/jobs/job?id=431","http://ab7028547dc9:4040/jobs/job?id=432","http://ab7028547dc9:4040/jobs/job?id=433","http://ab7028547dc9:4040/jobs/job?id=434","http://ab7028547dc9:4040/jobs/job?id=435","http://ab7028547dc9:4040/jobs/job?id=436","http://ab7028547dc9:4040/jobs/job?id=437","http://ab7028547dc9:4040/jobs/job?id=438","http://ab7028547dc9:4040/jobs/job?id=439","http://ab7028547dc9:4040/jobs/job?id=440","http://ab7028547dc9:4040/jobs/job?id=441","http://ab7028547dc9:4040/jobs/job?id=442","http://ab7028547dc9:4040/jobs/job?id=443","http://ab7028547dc9:4040/jobs/job?id=444","http://ab7028547dc9:4040/jobs/job?id=445","http://ab7028547dc9:4040/jobs/job?id=446","http://ab7028547dc9:4040/jobs/job?id=447","http://ab7028547dc9:4040/jobs/job?id=448","http://ab7028547dc9:4040/jobs/job?id=449","http://ab7028547dc9:4040/jobs/job?id=450","http://ab7028547dc9:4040/jobs/job?id=451","http://ab7028547dc9:4040/jobs/job?id=452","http://ab7028547dc9:4040/jobs/job?id=453","http://ab7028547dc9:4040/jobs/job?id=454","http://ab7028547dc9:4040/jobs/job?id=455","http://ab7028547dc9:4040/jobs/job?id=456","http://ab7028547dc9:4040/jobs/job?id=457","http://ab7028547dc9:4040/jobs/job?id=458","http://ab7028547dc9:4040/jobs/job?id=459","http://ab7028547dc9:4040/jobs/job?id=460","http://ab7028547dc9:4040/jobs/job?id=461","http://ab7028547dc9:4040/jobs/job?id=462","http://ab7028547dc9:4040/jobs/job?id=463","http://ab7028547dc9:4040/jobs/job?id=464","http://ab7028547dc9:4040/jobs/job?id=465","http://ab7028547dc9:4040/jobs/job?id=466","http://ab7028547dc9:4040/jobs/job?id=467","http://ab7028547dc9:4040/jobs/job?id=468","http://ab7028547dc9:4040/jobs/job?id=469","http://ab7028547dc9:4040/jobs/job?id=470","http://ab7028547dc9:4040/jobs/job?id=471","http://ab7028547dc9:4040/jobs/job?id=472","http://ab7028547dc9:4040/jobs/job?id=473","http://ab7028547dc9:4040/jobs/job?id=474","http://ab7028547dc9:4040/jobs/job?id=475","http://ab7028547dc9:4040/jobs/job?id=476","http://ab7028547dc9:4040/jobs/job?id=477","http://ab7028547dc9:4040/jobs/job?id=478","http://ab7028547dc9:4040/jobs/job?id=479","http://ab7028547dc9:4040/jobs/job?id=480","http://ab7028547dc9:4040/jobs/job?id=481","http://ab7028547dc9:4040/jobs/job?id=482","http://ab7028547dc9:4040/jobs/job?id=483","http://ab7028547dc9:4040/jobs/job?id=484","http://ab7028547dc9:4040/jobs/job?id=485","http://ab7028547dc9:4040/jobs/job?id=486","http://ab7028547dc9:4040/jobs/job?id=487","http://ab7028547dc9:4040/jobs/job?id=488","http://ab7028547dc9:4040/jobs/job?id=489","http://ab7028547dc9:4040/jobs/job?id=490","http://ab7028547dc9:4040/jobs/job?id=491","http://ab7028547dc9:4040/jobs/job?id=492","http://ab7028547dc9:4040/jobs/job?id=493","http://ab7028547dc9:4040/jobs/job?id=494","http://ab7028547dc9:4040/jobs/job?id=495","http://ab7028547dc9:4040/jobs/job?id=496","http://ab7028547dc9:4040/jobs/job?id=497","http://ab7028547dc9:4040/jobs/job?id=498","http://ab7028547dc9:4040/jobs/job?id=499","http://ab7028547dc9:4040/jobs/job?id=500","http://ab7028547dc9:4040/jobs/job?id=501","http://ab7028547dc9:4040/jobs/job?id=502","http://ab7028547dc9:4040/jobs/job?id=503","http://ab7028547dc9:4040/jobs/job?id=504","http://ab7028547dc9:4040/jobs/job?id=505","http://ab7028547dc9:4040/jobs/job?id=506","http://ab7028547dc9:4040/jobs/job?id=507","http://ab7028547dc9:4040/jobs/job?id=508","http://ab7028547dc9:4040/jobs/job?id=509","http://ab7028547dc9:4040/jobs/job?id=510","http://ab7028547dc9:4040/jobs/job?id=511","http://ab7028547dc9:4040/jobs/job?id=512","http://ab7028547dc9:4040/jobs/job?id=513","http://ab7028547dc9:4040/jobs/job?id=514","http://ab7028547dc9:4040/jobs/job?id=515","http://ab7028547dc9:4040/jobs/job?id=516","http://ab7028547dc9:4040/jobs/job?id=517","http://ab7028547dc9:4040/jobs/job?id=518","http://ab7028547dc9:4040/jobs/job?id=519","http://ab7028547dc9:4040/jobs/job?id=520","http://ab7028547dc9:4040/jobs/job?id=521","http://ab7028547dc9:4040/jobs/job?id=522","http://ab7028547dc9:4040/jobs/job?id=523","http://ab7028547dc9:4040/jobs/job?id=524","http://ab7028547dc9:4040/jobs/job?id=525","http://ab7028547dc9:4040/jobs/job?id=526","http://ab7028547dc9:4040/jobs/job?id=527","http://ab7028547dc9:4040/jobs/job?id=528","http://ab7028547dc9:4040/jobs/job?id=529","http://ab7028547dc9:4040/jobs/job?id=530","http://ab7028547dc9:4040/jobs/job?id=531","http://ab7028547dc9:4040/jobs/job?id=532","http://ab7028547dc9:4040/jobs/job?id=533","http://ab7028547dc9:4040/jobs/job?id=534","http://ab7028547dc9:4040/jobs/job?id=535","http://ab7028547dc9:4040/jobs/job?id=536","http://ab7028547dc9:4040/jobs/job?id=537","http://ab7028547dc9:4040/jobs/job?id=538","http://ab7028547dc9:4040/jobs/job?id=539","http://ab7028547dc9:4040/jobs/job?id=540","http://ab7028547dc9:4040/jobs/job?id=541","http://ab7028547dc9:4040/jobs/job?id=542","http://ab7028547dc9:4040/jobs/job?id=543","http://ab7028547dc9:4040/jobs/job?id=544","http://ab7028547dc9:4040/jobs/job?id=545","http://ab7028547dc9:4040/jobs/job?id=546","http://ab7028547dc9:4040/jobs/job?id=547","http://ab7028547dc9:4040/jobs/job?id=548","http://ab7028547dc9:4040/jobs/job?id=549","http://ab7028547dc9:4040/jobs/job?id=550","http://ab7028547dc9:4040/jobs/job?id=551","http://ab7028547dc9:4040/jobs/job?id=552","http://ab7028547dc9:4040/jobs/job?id=553","http://ab7028547dc9:4040/jobs/job?id=554","http://ab7028547dc9:4040/jobs/job?id=555","http://ab7028547dc9:4040/jobs/job?id=556","http://ab7028547dc9:4040/jobs/job?id=557","http://ab7028547dc9:4040/jobs/job?id=558","http://ab7028547dc9:4040/jobs/job?id=559","http://ab7028547dc9:4040/jobs/job?id=560","http://ab7028547dc9:4040/jobs/job?id=561","http://ab7028547dc9:4040/jobs/job?id=562","http://ab7028547dc9:4040/jobs/job?id=563","http://ab7028547dc9:4040/jobs/job?id=564","http://ab7028547dc9:4040/jobs/job?id=565","http://ab7028547dc9:4040/jobs/job?id=566","http://ab7028547dc9:4040/jobs/job?id=567","http://ab7028547dc9:4040/jobs/job?id=568","http://ab7028547dc9:4040/jobs/job?id=569","http://ab7028547dc9:4040/jobs/job?id=570","http://ab7028547dc9:4040/jobs/job?id=571","http://ab7028547dc9:4040/jobs/job?id=572","http://ab7028547dc9:4040/jobs/job?id=573","http://ab7028547dc9:4040/jobs/job?id=574","http://ab7028547dc9:4040/jobs/job?id=575","http://ab7028547dc9:4040/jobs/job?id=576","http://ab7028547dc9:4040/jobs/job?id=577","http://ab7028547dc9:4040/jobs/job?id=578","http://ab7028547dc9:4040/jobs/job?id=579","http://ab7028547dc9:4040/jobs/job?id=580","http://ab7028547dc9:4040/jobs/job?id=581","http://ab7028547dc9:4040/jobs/job?id=582","http://ab7028547dc9:4040/jobs/job?id=583","http://ab7028547dc9:4040/jobs/job?id=584","http://ab7028547dc9:4040/jobs/job?id=585","http://ab7028547dc9:4040/jobs/job?id=586","http://ab7028547dc9:4040/jobs/job?id=587","http://ab7028547dc9:4040/jobs/job?id=588","http://ab7028547dc9:4040/jobs/job?id=589","http://ab7028547dc9:4040/jobs/job?id=590","http://ab7028547dc9:4040/jobs/job?id=591","http://ab7028547dc9:4040/jobs/job?id=592","http://ab7028547dc9:4040/jobs/job?id=593","http://ab7028547dc9:4040/jobs/job?id=594","http://ab7028547dc9:4040/jobs/job?id=595","http://ab7028547dc9:4040/jobs/job?id=596","http://ab7028547dc9:4040/jobs/job?id=597","http://ab7028547dc9:4040/jobs/job?id=598","http://ab7028547dc9:4040/jobs/job?id=599","http://ab7028547dc9:4040/jobs/job?id=600","http://ab7028547dc9:4040/jobs/job?id=601","http://ab7028547dc9:4040/jobs/job?id=602","http://ab7028547dc9:4040/jobs/job?id=603","http://ab7028547dc9:4040/jobs/job?id=604","http://ab7028547dc9:4040/jobs/job?id=605","http://ab7028547dc9:4040/jobs/job?id=606","http://ab7028547dc9:4040/jobs/job?id=607","http://ab7028547dc9:4040/jobs/job?id=608","http://ab7028547dc9:4040/jobs/job?id=609","http://ab7028547dc9:4040/jobs/job?id=610","http://ab7028547dc9:4040/jobs/job?id=611","http://ab7028547dc9:4040/jobs/job?id=612","http://ab7028547dc9:4040/jobs/job?id=613","http://ab7028547dc9:4040/jobs/job?id=614","http://ab7028547dc9:4040/jobs/job?id=615","http://ab7028547dc9:4040/jobs/job?id=616","http://ab7028547dc9:4040/jobs/job?id=617","http://ab7028547dc9:4040/jobs/job?id=618","http://ab7028547dc9:4040/jobs/job?id=619","http://ab7028547dc9:4040/jobs/job?id=620","http://ab7028547dc9:4040/jobs/job?id=621","http://ab7028547dc9:4040/jobs/job?id=622","http://ab7028547dc9:4040/jobs/job?id=623","http://ab7028547dc9:4040/jobs/job?id=624","http://ab7028547dc9:4040/jobs/job?id=625","http://ab7028547dc9:4040/jobs/job?id=626","http://ab7028547dc9:4040/jobs/job?id=627","http://ab7028547dc9:4040/jobs/job?id=628","http://ab7028547dc9:4040/jobs/job?id=629","http://ab7028547dc9:4040/jobs/job?id=630","http://ab7028547dc9:4040/jobs/job?id=631","http://ab7028547dc9:4040/jobs/job?id=632","http://ab7028547dc9:4040/jobs/job?id=633","http://ab7028547dc9:4040/jobs/job?id=634","http://ab7028547dc9:4040/jobs/job?id=635","http://ab7028547dc9:4040/jobs/job?id=636","http://ab7028547dc9:4040/jobs/job?id=637","http://ab7028547dc9:4040/jobs/job?id=638","http://ab7028547dc9:4040/jobs/job?id=639","http://ab7028547dc9:4040/jobs/job?id=640","http://ab7028547dc9:4040/jobs/job?id=641","http://ab7028547dc9:4040/jobs/job?id=642","http://ab7028547dc9:4040/jobs/job?id=643","http://ab7028547dc9:4040/jobs/job?id=644","http://ab7028547dc9:4040/jobs/job?id=645","http://ab7028547dc9:4040/jobs/job?id=646","http://ab7028547dc9:4040/jobs/job?id=647","http://ab7028547dc9:4040/jobs/job?id=648","http://ab7028547dc9:4040/jobs/job?id=649","http://ab7028547dc9:4040/jobs/job?id=650","http://ab7028547dc9:4040/jobs/job?id=651","http://ab7028547dc9:4040/jobs/job?id=652","http://ab7028547dc9:4040/jobs/job?id=653","http://ab7028547dc9:4040/jobs/job?id=654","http://ab7028547dc9:4040/jobs/job?id=655","http://ab7028547dc9:4040/jobs/job?id=656","http://ab7028547dc9:4040/jobs/job?id=657","http://ab7028547dc9:4040/jobs/job?id=658","http://ab7028547dc9:4040/jobs/job?id=659","http://ab7028547dc9:4040/jobs/job?id=660","http://ab7028547dc9:4040/jobs/job?id=661","http://ab7028547dc9:4040/jobs/job?id=662","http://ab7028547dc9:4040/jobs/job?id=663","http://ab7028547dc9:4040/jobs/job?id=664","http://ab7028547dc9:4040/jobs/job?id=665","http://ab7028547dc9:4040/jobs/job?id=666","http://ab7028547dc9:4040/jobs/job?id=667","http://ab7028547dc9:4040/jobs/job?id=668","http://ab7028547dc9:4040/jobs/job?id=669","http://ab7028547dc9:4040/jobs/job?id=670","http://ab7028547dc9:4040/jobs/job?id=671","http://ab7028547dc9:4040/jobs/job?id=672","http://ab7028547dc9:4040/jobs/job?id=673","http://ab7028547dc9:4040/jobs/job?id=674","http://ab7028547dc9:4040/jobs/job?id=675","http://ab7028547dc9:4040/jobs/job?id=676","http://ab7028547dc9:4040/jobs/job?id=677","http://ab7028547dc9:4040/jobs/job?id=678","http://ab7028547dc9:4040/jobs/job?id=679","http://ab7028547dc9:4040/jobs/job?id=680","http://ab7028547dc9:4040/jobs/job?id=681","http://ab7028547dc9:4040/jobs/job?id=682","http://ab7028547dc9:4040/jobs/job?id=683","http://ab7028547dc9:4040/jobs/job?id=684","http://ab7028547dc9:4040/jobs/job?id=685","http://ab7028547dc9:4040/jobs/job?id=686","http://ab7028547dc9:4040/jobs/job?id=687","http://ab7028547dc9:4040/jobs/job?id=688","http://ab7028547dc9:4040/jobs/job?id=689","http://ab7028547dc9:4040/jobs/job?id=690","http://ab7028547dc9:4040/jobs/job?id=691","http://ab7028547dc9:4040/jobs/job?id=692","http://ab7028547dc9:4040/jobs/job?id=693","http://ab7028547dc9:4040/jobs/job?id=694","http://ab7028547dc9:4040/jobs/job?id=695","http://ab7028547dc9:4040/jobs/job?id=696","http://ab7028547dc9:4040/jobs/job?id=697","http://ab7028547dc9:4040/jobs/job?id=698","http://ab7028547dc9:4040/jobs/job?id=699","http://ab7028547dc9:4040/jobs/job?id=700","http://ab7028547dc9:4040/jobs/job?id=701","http://ab7028547dc9:4040/jobs/job?id=702","http://ab7028547dc9:4040/jobs/job?id=703","http://ab7028547dc9:4040/jobs/job?id=704","http://ab7028547dc9:4040/jobs/job?id=705","http://ab7028547dc9:4040/jobs/job?id=706","http://ab7028547dc9:4040/jobs/job?id=707","http://ab7028547dc9:4040/jobs/job?id=708","http://ab7028547dc9:4040/jobs/job?id=709","http://ab7028547dc9:4040/jobs/job?id=710","http://ab7028547dc9:4040/jobs/job?id=711","http://ab7028547dc9:4040/jobs/job?id=712","http://ab7028547dc9:4040/jobs/job?id=713","http://ab7028547dc9:4040/jobs/job?id=714","http://ab7028547dc9:4040/jobs/job?id=715","http://ab7028547dc9:4040/jobs/job?id=716","http://ab7028547dc9:4040/jobs/job?id=717","http://ab7028547dc9:4040/jobs/job?id=718","http://ab7028547dc9:4040/jobs/job?id=719","http://ab7028547dc9:4040/jobs/job?id=720","http://ab7028547dc9:4040/jobs/job?id=721","http://ab7028547dc9:4040/jobs/job?id=722","http://ab7028547dc9:4040/jobs/job?id=723","http://ab7028547dc9:4040/jobs/job?id=724","http://ab7028547dc9:4040/jobs/job?id=725","http://ab7028547dc9:4040/jobs/job?id=726","http://ab7028547dc9:4040/jobs/job?id=727","http://ab7028547dc9:4040/jobs/job?id=728","http://ab7028547dc9:4040/jobs/job?id=729","http://ab7028547dc9:4040/jobs/job?id=730","http://ab7028547dc9:4040/jobs/job?id=731","http://ab7028547dc9:4040/jobs/job?id=732","http://ab7028547dc9:4040/jobs/job?id=733","http://ab7028547dc9:4040/jobs/job?id=734","http://ab7028547dc9:4040/jobs/job?id=735","http://ab7028547dc9:4040/jobs/job?id=736","http://ab7028547dc9:4040/jobs/job?id=737","http://ab7028547dc9:4040/jobs/job?id=738","http://ab7028547dc9:4040/jobs/job?id=739","http://ab7028547dc9:4040/jobs/job?id=740","http://ab7028547dc9:4040/jobs/job?id=741","http://ab7028547dc9:4040/jobs/job?id=742","http://ab7028547dc9:4040/jobs/job?id=743","http://ab7028547dc9:4040/jobs/job?id=744","http://ab7028547dc9:4040/jobs/job?id=745","http://ab7028547dc9:4040/jobs/job?id=746","http://ab7028547dc9:4040/jobs/job?id=747","http://ab7028547dc9:4040/jobs/job?id=748","http://ab7028547dc9:4040/jobs/job?id=749","http://ab7028547dc9:4040/jobs/job?id=750","http://ab7028547dc9:4040/jobs/job?id=751","http://ab7028547dc9:4040/jobs/job?id=752","http://ab7028547dc9:4040/jobs/job?id=753","http://ab7028547dc9:4040/jobs/job?id=754","http://ab7028547dc9:4040/jobs/job?id=755","http://ab7028547dc9:4040/jobs/job?id=756","http://ab7028547dc9:4040/jobs/job?id=757","http://ab7028547dc9:4040/jobs/job?id=758","http://ab7028547dc9:4040/jobs/job?id=759","http://ab7028547dc9:4040/jobs/job?id=760","http://ab7028547dc9:4040/jobs/job?id=761","http://ab7028547dc9:4040/jobs/job?id=762","http://ab7028547dc9:4040/jobs/job?id=763","http://ab7028547dc9:4040/jobs/job?id=764","http://ab7028547dc9:4040/jobs/job?id=765","http://ab7028547dc9:4040/jobs/job?id=766","http://ab7028547dc9:4040/jobs/job?id=767","http://ab7028547dc9:4040/jobs/job?id=768","http://ab7028547dc9:4040/jobs/job?id=769","http://ab7028547dc9:4040/jobs/job?id=770","http://ab7028547dc9:4040/jobs/job?id=771","http://ab7028547dc9:4040/jobs/job?id=772","http://ab7028547dc9:4040/jobs/job?id=773","http://ab7028547dc9:4040/jobs/job?id=774","http://ab7028547dc9:4040/jobs/job?id=775","http://ab7028547dc9:4040/jobs/job?id=776","http://ab7028547dc9:4040/jobs/job?id=777","http://ab7028547dc9:4040/jobs/job?id=778","http://ab7028547dc9:4040/jobs/job?id=779","http://ab7028547dc9:4040/jobs/job?id=780","http://ab7028547dc9:4040/jobs/job?id=781","http://ab7028547dc9:4040/jobs/job?id=782","http://ab7028547dc9:4040/jobs/job?id=783","http://ab7028547dc9:4040/jobs/job?id=784","http://ab7028547dc9:4040/jobs/job?id=785","http://ab7028547dc9:4040/jobs/job?id=786","http://ab7028547dc9:4040/jobs/job?id=787","http://ab7028547dc9:4040/jobs/job?id=788","http://ab7028547dc9:4040/jobs/job?id=789","http://ab7028547dc9:4040/jobs/job?id=790","http://ab7028547dc9:4040/jobs/job?id=791","http://ab7028547dc9:4040/jobs/job?id=792","http://ab7028547dc9:4040/jobs/job?id=793","http://ab7028547dc9:4040/jobs/job?id=794","http://ab7028547dc9:4040/jobs/job?id=795","http://ab7028547dc9:4040/jobs/job?id=796","http://ab7028547dc9:4040/jobs/job?id=797","http://ab7028547dc9:4040/jobs/job?id=798","http://ab7028547dc9:4040/jobs/job?id=799","http://ab7028547dc9:4040/jobs/job?id=800","http://ab7028547dc9:4040/jobs/job?id=801","http://ab7028547dc9:4040/jobs/job?id=802","http://ab7028547dc9:4040/jobs/job?id=803","http://ab7028547dc9:4040/jobs/job?id=804","http://ab7028547dc9:4040/jobs/job?id=805","http://ab7028547dc9:4040/jobs/job?id=806","http://ab7028547dc9:4040/jobs/job?id=807","http://ab7028547dc9:4040/jobs/job?id=808","http://ab7028547dc9:4040/jobs/job?id=809","http://ab7028547dc9:4040/jobs/job?id=810","http://ab7028547dc9:4040/jobs/job?id=811","http://ab7028547dc9:4040/jobs/job?id=812","http://ab7028547dc9:4040/jobs/job?id=813","http://ab7028547dc9:4040/jobs/job?id=814","http://ab7028547dc9:4040/jobs/job?id=815","http://ab7028547dc9:4040/jobs/job?id=816","http://ab7028547dc9:4040/jobs/job?id=817","http://ab7028547dc9:4040/jobs/job?id=818","http://ab7028547dc9:4040/jobs/job?id=819","http://ab7028547dc9:4040/jobs/job?id=820","http://ab7028547dc9:4040/jobs/job?id=821","http://ab7028547dc9:4040/jobs/job?id=822","http://ab7028547dc9:4040/jobs/job?id=823","http://ab7028547dc9:4040/jobs/job?id=824","http://ab7028547dc9:4040/jobs/job?id=825","http://ab7028547dc9:4040/jobs/job?id=826","http://ab7028547dc9:4040/jobs/job?id=827","http://ab7028547dc9:4040/jobs/job?id=828","http://ab7028547dc9:4040/jobs/job?id=829","http://ab7028547dc9:4040/jobs/job?id=830","http://ab7028547dc9:4040/jobs/job?id=831","http://ab7028547dc9:4040/jobs/job?id=832","http://ab7028547dc9:4040/jobs/job?id=833","http://ab7028547dc9:4040/jobs/job?id=834","http://ab7028547dc9:4040/jobs/job?id=835","http://ab7028547dc9:4040/jobs/job?id=836","http://ab7028547dc9:4040/jobs/job?id=837","http://ab7028547dc9:4040/jobs/job?id=838","http://ab7028547dc9:4040/jobs/job?id=839","http://ab7028547dc9:4040/jobs/job?id=840","http://ab7028547dc9:4040/jobs/job?id=841","http://ab7028547dc9:4040/jobs/job?id=842","http://ab7028547dc9:4040/jobs/job?id=843","http://ab7028547dc9:4040/jobs/job?id=844","http://ab7028547dc9:4040/jobs/job?id=845","http://ab7028547dc9:4040/jobs/job?id=846","http://ab7028547dc9:4040/jobs/job?id=847","http://ab7028547dc9:4040/jobs/job?id=848","http://ab7028547dc9:4040/jobs/job?id=849","http://ab7028547dc9:4040/jobs/job?id=850","http://ab7028547dc9:4040/jobs/job?id=851","http://ab7028547dc9:4040/jobs/job?id=852","http://ab7028547dc9:4040/jobs/job?id=853","http://ab7028547dc9:4040/jobs/job?id=854","http://ab7028547dc9:4040/jobs/job?id=855","http://ab7028547dc9:4040/jobs/job?id=856","http://ab7028547dc9:4040/jobs/job?id=857","http://ab7028547dc9:4040/jobs/job?id=858","http://ab7028547dc9:4040/jobs/job?id=859","http://ab7028547dc9:4040/jobs/job?id=860","http://ab7028547dc9:4040/jobs/job?id=861","http://ab7028547dc9:4040/jobs/job?id=862","http://ab7028547dc9:4040/jobs/job?id=863","http://ab7028547dc9:4040/jobs/job?id=864","http://ab7028547dc9:4040/jobs/job?id=865","http://ab7028547dc9:4040/jobs/job?id=866","http://ab7028547dc9:4040/jobs/job?id=867","http://ab7028547dc9:4040/jobs/job?id=868","http://ab7028547dc9:4040/jobs/job?id=869","http://ab7028547dc9:4040/jobs/job?id=870","http://ab7028547dc9:4040/jobs/job?id=871","http://ab7028547dc9:4040/jobs/job?id=872","http://ab7028547dc9:4040/jobs/job?id=873","http://ab7028547dc9:4040/jobs/job?id=874","http://ab7028547dc9:4040/jobs/job?id=875","http://ab7028547dc9:4040/jobs/job?id=876","http://ab7028547dc9:4040/jobs/job?id=877","http://ab7028547dc9:4040/jobs/job?id=878","http://ab7028547dc9:4040/jobs/job?id=879","http://ab7028547dc9:4040/jobs/job?id=880","http://ab7028547dc9:4040/jobs/job?id=881","http://ab7028547dc9:4040/jobs/job?id=882","http://ab7028547dc9:4040/jobs/job?id=883","http://ab7028547dc9:4040/jobs/job?id=884","http://ab7028547dc9:4040/jobs/job?id=885","http://ab7028547dc9:4040/jobs/job?id=886","http://ab7028547dc9:4040/jobs/job?id=887","http://ab7028547dc9:4040/jobs/job?id=888","http://ab7028547dc9:4040/jobs/job?id=889","http://ab7028547dc9:4040/jobs/job?id=890","http://ab7028547dc9:4040/jobs/job?id=891","http://ab7028547dc9:4040/jobs/job?id=892","http://ab7028547dc9:4040/jobs/job?id=893","http://ab7028547dc9:4040/jobs/job?id=894","http://ab7028547dc9:4040/jobs/job?id=895","http://ab7028547dc9:4040/jobs/job?id=896","http://ab7028547dc9:4040/jobs/job?id=897","http://ab7028547dc9:4040/jobs/job?id=898","http://ab7028547dc9:4040/jobs/job?id=899","http://ab7028547dc9:4040/jobs/job?id=900","http://ab7028547dc9:4040/jobs/job?id=901","http://ab7028547dc9:4040/jobs/job?id=902","http://ab7028547dc9:4040/jobs/job?id=903","http://ab7028547dc9:4040/jobs/job?id=904","http://ab7028547dc9:4040/jobs/job?id=905","http://ab7028547dc9:4040/jobs/job?id=906","http://ab7028547dc9:4040/jobs/job?id=907","http://ab7028547dc9:4040/jobs/job?id=908","http://ab7028547dc9:4040/jobs/job?id=909","http://ab7028547dc9:4040/jobs/job?id=910","http://ab7028547dc9:4040/jobs/job?id=911","http://ab7028547dc9:4040/jobs/job?id=912","http://ab7028547dc9:4040/jobs/job?id=913","http://ab7028547dc9:4040/jobs/job?id=914","http://ab7028547dc9:4040/jobs/job?id=915","http://ab7028547dc9:4040/jobs/job?id=916","http://ab7028547dc9:4040/jobs/job?id=917","http://ab7028547dc9:4040/jobs/job?id=918","http://ab7028547dc9:4040/jobs/job?id=919","http://ab7028547dc9:4040/jobs/job?id=920","http://ab7028547dc9:4040/jobs/job?id=921","http://ab7028547dc9:4040/jobs/job?id=922","http://ab7028547dc9:4040/jobs/job?id=923","http://ab7028547dc9:4040/jobs/job?id=924","http://ab7028547dc9:4040/jobs/job?id=925","http://ab7028547dc9:4040/jobs/job?id=926","http://ab7028547dc9:4040/jobs/job?id=927","http://ab7028547dc9:4040/jobs/job?id=928","http://ab7028547dc9:4040/jobs/job?id=929","http://ab7028547dc9:4040/jobs/job?id=930","http://ab7028547dc9:4040/jobs/job?id=931","http://ab7028547dc9:4040/jobs/job?id=932","http://ab7028547dc9:4040/jobs/job?id=933","http://ab7028547dc9:4040/jobs/job?id=934","http://ab7028547dc9:4040/jobs/job?id=935","http://ab7028547dc9:4040/jobs/job?id=936","http://ab7028547dc9:4040/jobs/job?id=937","http://ab7028547dc9:4040/jobs/job?id=938","http://ab7028547dc9:4040/jobs/job?id=939","http://ab7028547dc9:4040/jobs/job?id=940","http://ab7028547dc9:4040/jobs/job?id=941","http://ab7028547dc9:4040/jobs/job?id=942","http://ab7028547dc9:4040/jobs/job?id=943","http://ab7028547dc9:4040/jobs/job?id=944","http://ab7028547dc9:4040/jobs/job?id=945","http://ab7028547dc9:4040/jobs/job?id=946","http://ab7028547dc9:4040/jobs/job?id=947","http://ab7028547dc9:4040/jobs/job?id=948","http://ab7028547dc9:4040/jobs/job?id=949","http://ab7028547dc9:4040/jobs/job?id=950","http://ab7028547dc9:4040/jobs/job?id=951","http://ab7028547dc9:4040/jobs/job?id=952","http://ab7028547dc9:4040/jobs/job?id=953","http://ab7028547dc9:4040/jobs/job?id=954","http://ab7028547dc9:4040/jobs/job?id=955","http://ab7028547dc9:4040/jobs/job?id=956","http://ab7028547dc9:4040/jobs/job?id=957","http://ab7028547dc9:4040/jobs/job?id=958","http://ab7028547dc9:4040/jobs/job?id=959","http://ab7028547dc9:4040/jobs/job?id=960","http://ab7028547dc9:4040/jobs/job?id=961","http://ab7028547dc9:4040/jobs/job?id=962","http://ab7028547dc9:4040/jobs/job?id=963","http://ab7028547dc9:4040/jobs/job?id=964","http://ab7028547dc9:4040/jobs/job?id=965","http://ab7028547dc9:4040/jobs/job?id=966","http://ab7028547dc9:4040/jobs/job?id=967","http://ab7028547dc9:4040/jobs/job?id=968","http://ab7028547dc9:4040/jobs/job?id=969","http://ab7028547dc9:4040/jobs/job?id=970","http://ab7028547dc9:4040/jobs/job?id=971","http://ab7028547dc9:4040/jobs/job?id=972","http://ab7028547dc9:4040/jobs/job?id=973","http://ab7028547dc9:4040/jobs/job?id=974","http://ab7028547dc9:4040/jobs/job?id=975","http://ab7028547dc9:4040/jobs/job?id=976","http://ab7028547dc9:4040/jobs/job?id=977","http://ab7028547dc9:4040/jobs/job?id=978","http://ab7028547dc9:4040/jobs/job?id=979","http://ab7028547dc9:4040/jobs/job?id=980","http://ab7028547dc9:4040/jobs/job?id=981","http://ab7028547dc9:4040/jobs/job?id=982","http://ab7028547dc9:4040/jobs/job?id=983","http://ab7028547dc9:4040/jobs/job?id=984","http://ab7028547dc9:4040/jobs/job?id=985","http://ab7028547dc9:4040/jobs/job?id=986","http://ab7028547dc9:4040/jobs/job?id=987","http://ab7028547dc9:4040/jobs/job?id=988","http://ab7028547dc9:4040/jobs/job?id=989","http://ab7028547dc9:4040/jobs/job?id=990","http://ab7028547dc9:4040/jobs/job?id=991","http://ab7028547dc9:4040/jobs/job?id=992","http://ab7028547dc9:4040/jobs/job?id=993","http://ab7028547dc9:4040/jobs/job?id=994","http://ab7028547dc9:4040/jobs/job?id=995","http://ab7028547dc9:4040/jobs/job?id=996","http://ab7028547dc9:4040/jobs/job?id=997","http://ab7028547dc9:4040/jobs/job?id=998","http://ab7028547dc9:4040/jobs/job?id=999","http://ab7028547dc9:4040/jobs/job?id=1000","http://ab7028547dc9:4040/jobs/job?id=1001","http://ab7028547dc9:4040/jobs/job?id=1002","http://ab7028547dc9:4040/jobs/job?id=1003","http://ab7028547dc9:4040/jobs/job?id=1004","http://ab7028547dc9:4040/jobs/job?id=1005","http://ab7028547dc9:4040/jobs/job?id=1006","http://ab7028547dc9:4040/jobs/job?id=1007","http://ab7028547dc9:4040/jobs/job?id=1008","http://ab7028547dc9:4040/jobs/job?id=1009","http://ab7028547dc9:4040/jobs/job?id=1010","http://ab7028547dc9:4040/jobs/job?id=1011","http://ab7028547dc9:4040/jobs/job?id=1012","http://ab7028547dc9:4040/jobs/job?id=1013","http://ab7028547dc9:4040/jobs/job?id=1014","http://ab7028547dc9:4040/jobs/job?id=1015","http://ab7028547dc9:4040/jobs/job?id=1016","http://ab7028547dc9:4040/jobs/job?id=1017","http://ab7028547dc9:4040/jobs/job?id=1018"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677662_-734921125","id":"20171129-113112_994877662","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:11:44+0000","dateFinished":"2019-02-20T17:13:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53224"},{"text":"val featureImportances = pipelineModel.bestModel.asInstanceOf[PipelineModel].stages(stringIndexers.size + 2).asInstanceOf[RandomForestClassificationModel].featureImportances\n\nassembler.getInputCols.zip(featureImportances.toArray).sortBy(-_._2).foreach { case (feat, imp) => println(s\"feature: $feat, importance: $imp\") }\n","user":"anonymous","dateUpdated":"2019-02-20T17:14:50+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"feature: crsdeptime, importance: 0.25434598344579173\nfeature: crsarrtime, importance: 0.22645018613800164\nfeature: orig_destIndexed, importance: 0.19194350367566315\nfeature: crsdephour, importance: 0.11921205532664048\nfeature: destIndexed, importance: 0.06609553590373374\nfeature: dofWIndexed, importance: 0.03781167379653163\nfeature: carrierIndexed, importance: 0.037636670623576896\nfeature: dist, importance: 0.03445973902781022\nfeature: originIndexed, importance: 0.017004831687461995\nfeature: crselapsedtime, importance: 0.015039820374788621\nfeatureImportances: org.apache.spark.ml.linalg.Vector = (10,[0,1,2,3,4,5,6,7,8,9],[0.037636670623576896,0.06609553590373374,0.017004831687461995,0.03781167379653163,0.19194350367566315,0.11921205532664048,0.25434598344579173,0.22645018613800164,0.015039820374788621,0.03445973902781022])\n"}]},"apps":[],"jobName":"paragraph_1550681677663_-1069292586","id":"20171122-232203_359528816","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:14:50+0000","dateFinished":"2019-02-20T17:14:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53225"},{"text":"val bestEstimatorParamMap = pipelineModel.getEstimatorParamMaps.zip(pipelineModel.avgMetrics).maxBy(_._2)._1\nprintln(s\"Best params:\\n$bestEstimatorParamMap\")","user":"anonymous","dateUpdated":"2019-02-20T17:14:59+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Best params:\n{\n\trfc_ac7eebf816e9-impurity: gini,\n\trfc_ac7eebf816e9-maxBins: 200,\n\trfc_ac7eebf816e9-maxDepth: 4,\n\trfc_ac7eebf816e9-numTrees: 20\n}\nbestEstimatorParamMap: org.apache.spark.ml.param.ParamMap =\n{\n\trfc_ac7eebf816e9-impurity: gini,\n\trfc_ac7eebf816e9-maxBins: 200,\n\trfc_ac7eebf816e9-maxDepth: 4,\n\trfc_ac7eebf816e9-numTrees: 20\n}\n"}]},"apps":[],"jobName":"paragraph_1550681677663_-1920489413","id":"20171122-232845_814296940","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:14:59+0000","dateFinished":"2019-02-20T17:15:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53226"},{"text":"%md\r\n## Evaluate the model on a test set\r\nThe actual performance of the model can be determined using the test data set which has not been used for any training or cross-validation activities. We'll transform the test set with the model pipeline, which will map the features according to the same recipe. \r\n","user":"anonymous","dateUpdated":"2019-02-20T17:15:41+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Evaluate the model on a test set</h2>\n<p>The actual performance of the model can be determined using the test data set which has not been used for any training or cross-validation activities. We&rsquo;ll transform the test set with the model pipeline, which will map the features according to the same recipe.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1550681677663_-865378352","id":"20170602-155317_1487132664","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:15:41+0000","dateFinished":"2019-02-20T17:15:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53227"},{"title":"Get Predictions from Test data","text":"//transform the test set with the model pipeline,\n//which will map the features according to the same recipe\n\nval predictions = pipelineModel.transform(testData)\n","user":"anonymous","dateUpdated":"2019-02-20T17:15:46+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"predictions: org.apache.spark.sql.DataFrame = [_id: string, dofW: int ... 22 more fields]\n"}]},"apps":[],"jobName":"paragraph_1550681677664_388296512","id":"20170508-155848_1997894070","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:15:46+0000","dateFinished":"2019-02-20T17:15:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53228"},{"text":"%md\nAccuracy is measured by the area under the ROC curve. The area measures the ability of the test to correctly classify true positives from false positives. A random predictor would have .5 accuracy. The closer the value is to 1 the better its predictions are. \n\n","user":"anonymous","dateUpdated":"2019-02-20T16:54:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Accuracy is measured by the area under the ROC curve. The area measures the ability of the test to correctly classify true positives from false positives. A random predictor would have .5 accuracy. The closer the value is to 1 the better its predictions are.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1550681677664_1247608850","id":"20170602-161538_1648758337","dateCreated":"2019-02-20T16:54:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53229"},{"title":"Evaluate the predictions accuracy","text":"\nval areaUnderROC = evaluator.evaluate(predictions)\nprintln(\"areaUnderROC \"  + areaUnderROC)\n","user":"anonymous","dateUpdated":"2019-02-20T17:15:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"areaUnderROC 0.6945482322554366\nareaUnderROC: Double = 0.6945482322554366\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=1019","http://ab7028547dc9:4040/jobs/job?id=1020","http://ab7028547dc9:4040/jobs/job?id=1021","http://ab7028547dc9:4040/jobs/job?id=1022"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677665_607695191","id":"20170602-155622_1453197792","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:15:56+0000","dateFinished":"2019-02-20T17:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53230"},{"title":"Calculate some more metrics","text":"val lp = predictions.select( \"label\", \"prediction\")\nval counttotal = predictions.count()\nval correct = lp.filter($\"label\" === $\"prediction\").count()\nval wrong = lp.filter(not($\"label\" === $\"prediction\")).count()\nval truep =( lp.filter($\"prediction\" === 0.0).filter($\"label\" === $\"prediction\").count()) /counttotal.toDouble\nval truen = (lp.filter($\"prediction\" === 1.0).filter($\"label\" === $\"prediction\").count())/counttotal.toDouble\nval falsen = (lp.filter($\"prediction\" === 0.0).filter(not($\"label\" === $\"prediction\")).count())/counttotal.toDouble\nval falsep = (lp.filter($\"prediction\" === 1.0).filter(not($\"label\" === $\"prediction\")).count())/counttotal.toDouble\nval ratioWrong=wrong.toDouble/counttotal.toDouble\nval ratioCorrect=correct.toDouble/counttotal.toDouble\n\nval precision = truep / (truep + falsep)\nval recall = truep / (truep + falsen)\nval fmeasure = 2 * precision * recall / (precision + recall)","user":"anonymous","dateUpdated":"2019-02-20T17:16:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"lp: org.apache.spark.sql.DataFrame = [label: double, prediction: double]\ncounttotal: Long = 41348\ncorrect: Long = 25286\nwrong: Long = 16062\ntruep: Double = 0.5360839702041211\ntruen: Double = 0.0754570958692077\nfalsen: Double = 0.03477798200638483\nfalsep: Double = 0.35368095192028637\nratioWrong: Double = 0.3884589339266712\nratioCorrect: Double = 0.6115410660733288\nprecision: Double = 0.6025006795324817\nrecall: Double = 0.9390781223521437\nfmeasure: Double = 0.7340464284531576\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=1023","http://ab7028547dc9:4040/jobs/job?id=1024","http://ab7028547dc9:4040/jobs/job?id=1025","http://ab7028547dc9:4040/jobs/job?id=1026","http://ab7028547dc9:4040/jobs/job?id=1027","http://ab7028547dc9:4040/jobs/job?id=1028","http://ab7028547dc9:4040/jobs/job?id=1029"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677665_-1176765504","id":"20181015-224231_2027590368","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:16:03+0000","dateFinished":"2019-02-20T17:16:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53231"},{"text":"println( \"ratio Correct\" + ratioCorrect +\"\\nratio wrong \"+ratioWrong +\"\\ntrue positive \"+truep + \"\\ntrue negative \"+ truen + \"\\nfalse negative \" + falsen+  \"\\nfalse positive \"+ falsep )","user":"anonymous","dateUpdated":"2019-02-20T17:16:18+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ratio Correct0.6115410660733288\nratio wrong 0.3884589339266712\ntrue positive 0.5360839702041211\ntrue negative 0.0754570958692077\nfalse negative 0.03477798200638483\nfalse positive 0.35368095192028637\n"}]},"apps":[],"jobName":"paragraph_1550681677666_1852786030","id":"20181004-211413_1357524146","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:16:19+0000","dateFinished":"2019-02-20T17:16:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53232"},{"text":"println( \"\\nprecision \"+ precision+ \"\\nrecall \" + recall+ \"\\nf_measure \" + fmeasure )","user":"anonymous","dateUpdated":"2019-02-20T17:16:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nprecision 0.6025006795324817\nrecall 0.9390781223521437\nf_measure 0.7340464284531576\n"}]},"apps":[],"jobName":"paragraph_1550681677666_-240722305","id":"20181015-213933_2083506099","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:16:24+0000","dateFinished":"2019-02-20T17:16:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53233"},{"text":"predictions.select(\"label\",\"prediction\",\"crsdephour\").show","user":"anonymous","dateUpdated":"2019-02-20T17:16:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+----------+----------+\n|label|prediction|crsdephour|\n+-----+----------+----------+\n|  0.0|       0.0|        11|\n|  0.0|       0.0|        13|\n|  0.0|       0.0|        14|\n|  0.0|       1.0|        16|\n|  0.0|       1.0|        18|\n|  0.0|       1.0|        19|\n|  0.0|       0.0|        22|\n|  0.0|       0.0|         9|\n|  0.0|       0.0|        10|\n|  0.0|       0.0|        11|\n|  0.0|       0.0|        13|\n|  0.0|       0.0|        14|\n|  0.0|       0.0|        14|\n|  0.0|       0.0|        15|\n|  1.0|       1.0|        16|\n|  1.0|       1.0|        18|\n|  0.0|       1.0|        19|\n|  1.0|       1.0|        21|\n|  0.0|       0.0|        22|\n|  0.0|       0.0|         7|\n+-----+----------+----------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ab7028547dc9:4040/jobs/job?id=1030"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1550681677667_-216988544","id":"20171107-112947_525619195","dateCreated":"2019-02-20T16:54:37+0000","dateStarted":"2019-02-20T17:16:37+0000","dateFinished":"2019-02-20T17:16:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53234"},{"user":"anonymous","dateUpdated":"2019-02-20T16:54:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1550681677667_870267975","id":"20171122-091021_1615582434","dateCreated":"2019-02-20T16:54:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53235"}],"name":"Flight Delay Prediction","id":"2E49VH9TK","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"python:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"spark:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}